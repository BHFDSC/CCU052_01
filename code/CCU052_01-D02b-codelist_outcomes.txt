# Databricks notebook source
# MAGIC %md # CCU0052-D02b-codelist_exposures_and_outcomes
# MAGIC
# MAGIC **Description** This notebook creates the codelist for the exposures and outcomes, which includes codelists for Atrial Fibrillation, Hypertension, Myocardial infarction, and Stroke. The notebook includes a comparison with the codelist provided by LCP and the bhf_phenotypes table.
# MAGIC
# MAGIC **Authors** Tom Bolton, John Nolan
# MAGIC
# MAGIC **Reviewers** âš  UNREVIEWED
# MAGIC
# MAGIC **Acknowledgements** Based on CCU002_07
# MAGIC
# MAGIC **Notes**

# COMMAND ----------

# MAGIC %md # 0. Setup

# COMMAND ----------

spark.sql('CLEAR CACHE')

# COMMAND ----------

# DBTITLE 1,Libraries
import pyspark.sql.functions as f
import pyspark.sql.types as t
from pyspark.sql import Window

from functools import reduce

import databricks.koalas as ks
import pandas as pd
import numpy as np

import re
import io
import datetime

import matplotlib
import matplotlib.pyplot as plt
from matplotlib import dates as mdates
import seaborn as sns

print("Matplotlib version: ", matplotlib.__version__)
print("Seaborn version: ", sns.__version__)
_datetimenow = datetime.datetime.now() # .strftime("%Y%m%d")
print(f"_datetimenow:  {_datetimenow}")

# COMMAND ----------

# DBTITLE 1,Functions
# %run "/Workspaces/dars_nic_391419_j3w9t_collab/SHDS/common/functions"

# COMMAND ----------

# MAGIC %run "../../../../shds/common/functions"

# COMMAND ----------

# MAGIC %md # 1. Parameters

# COMMAND ----------

# MAGIC %run "./CCU052_01-D01-parameters"

# COMMAND ----------

# widgets for reference
dbutils.widgets.removeAll()
dbutils.widgets.text('1 project', project)
dbutils.widgets.text('2 subproject', subproject)
dbutils.widgets.text('3 cohort', cohort)
dbutils.widgets.text('4 version', version)
dbutils.widgets.text('5 proj', proj)

# COMMAND ----------

# MAGIC %md # 2. Data

# COMMAND ----------

# bhf_phenotypes = spark.table(path_ref_bhf_phenotypes)

# COMMAND ----------

# v1 pre 20230424 (from protocol)
# codelist_hw = """
# terminology,code,term,name
# SNOMED,106001000119101,chronic obstructive lung disease co-occurrent with acute bronchitis (disorder),copd
# SNOMED,135836000,end stage chronic obstructive airways disease (disorder),copd
# SNOMED,13645005,chronic obstructive lung disease (disorder),copd
# SNOMED,16003001,giant bullous emphysema (disorder),copd
# SNOMED,16846004,obstructive emphysema (disorder),copd
# SNOMED,185086009,chronic obstructive bronchitis (disorder),copd
# SNOMED,195951007,acute exacerbation of chronic obstructive airways disease (disorder),copd
# SNOMED,195958001,segmental bullous emphysema (disorder),copd
# SNOMED,195959009,zonal bullous emphysema (disorder),copd
# SNOMED,196001008,chronic obstructive pulmonary disease with acute lower respiratory infection (disorder),copd
# SNOMED,233674008,pulmonary emphysema in alpha-1 primary immunodeficiency deficiency (disorder),copd
# SNOMED,266355005,bullous emphysema with collapse (disorder),copd
# SNOMED,285381006,acute infective exacerbation of chronic obstructive airways disease (disorder),copd
# SNOMED,293241000119100,acute exacerbation of chronic obstructive bronchitis (disorder),copd
# SNOMED,293991000000106,very severe chronic obstructive pulmonary disease (disorder),copd
# SNOMED,313296004,mild chronic obstructive pulmonary disease (disorder),copd
# SNOMED,313297008,moderate chronic obstructive pulmonary disease (disorder),copd
# SNOMED,313299006,severe chronic obstructive pulmonary disease (disorder),copd
# SNOMED,31898008,paraseptal emphysema (disorder),copd
# SNOMED,45145000,unilateral emphysema (situation),copd
# SNOMED,4981000,panacinar emphysema (disorder),copd
# SNOMED,66110007,chronic diffuse emphysema caused by inhalation of chemical fumes and/or vapors (disorder),copd
# SNOMED,68328006,centriacinar emphysema (disorder),copd
# SNOMED,847091000000104,acute non-infective exacerbation of chronic obstructive pulmonary disease (disorder),copd
# SNOMED,87433001,pulmonary emphysema (disorder),copd
# SNOMED,408501008,emergency hospital admission for chronic obstructive pulmonary disease (procedure),copd
# SNOMED,723245007,number of chronic obstructive pulmonary disease exacerbations in past year (observable entity),copd
# SNOMED,1066231000000103,chronic obstructive pulmonary disease monitoring email invitation (procedure),copd
# SNOMED,1066281000000104,chronic obstructive pulmonary disease monitoring short message service text message invitation (procedure),copd
# SNOMED,1066821000000101,chronic obstructive pulmonary disease monitoring short message service text message first invitation (procedure),copd
# SNOMED,1066841000000108,chronic obstructive pulmonary disease monitoring short message service text message second invitation (procedure),copd
# SNOMED,1066851000000106,chronic obstructive pulmonary disease monitoring short message service text message third invitation (procedure),copd
# SNOMED,1110861000000102,quality and outcomes framework chronic obstructive pulmonary disease quality indicator-related care invitation (procedure),copd
# SNOMED,143371000000104,quality and outcomes framework chronic obstructive pulmonary disease quality indicator-related care invitation using preferred method of communication (procedure),copd
# SNOMED,711431000000109,chronic obstructive pulmonary disease monitoring invitation (procedure),copd
# SNOMED,716241000000106,chronic obstructive pulmonary disease monitoring first letter (procedure),copd
# SNOMED,716281000000103,chronic obstructive pulmonary disease monitoring verbal invitation (procedure),copd
# SNOMED,716901000000101,chronic obstructive pulmonary disease monitoring telephone invitation (procedure),copd
# SNOMED,717021000000106,chronic obstructive pulmonary disease monitoring second letter (procedure),copd
# SNOMED,717521000000104,chronic obstructive pulmonary disease monitoring third letter (procedure),copd
# SNOMED,716291000000101,excepted from chronic obstructive pulmonary disease quality indicators - informed dissent (finding),copd
# SNOMED,716311000000100,excepted from chronic obstructive pulmonary disease quality indicators - patient unsuitable (finding),copd
# SNOMED,1108721000000102,excepted from chronic obstructive pulmonary disease quality indicators - service unavailable (finding),copd
# SNOMED,941201000000103,chronic obstructive pulmonary disease resolved (finding),copd
# SNOMED,394703002,chronic obstructive pulmonary disease annual review (regime/therapy),copd
# SNOMED,760601000000107,chronic obstructive pulmonary disease 3 monthly review (regime/therapy),copd
# SNOMED,760621000000103,chronic obstructive pulmonary disease 6 monthly review (regime/therapy),copd
# SNOMED,371611000000107,chronic obstructive pulmonary disease patient unsuitable for pulmonary rehabilitation (finding),copd
# SNOMED,836477007,chronic emphysema caused by vapor (disorder),copd
# SNOMED,1010333003,emphysema of left lung (disorder),copd
# SNOMED,1010334009,emphysema of right lung (disorder),copd
# SNOMED,1064811000000103,moderate acute exacerbation of asthma (disorder),asthma
# SNOMED,1064821000000109,life threatening acute exacerbation of asthma (disorder),asthma
# SNOMED,10674711000119105,acute severe exacerbation of asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10675391000119101,severe controlled persistent asthma (disorder),asthma
# SNOMED,10675431000119106,severe persistent allergic asthma (disorder),asthma
# SNOMED,10675471000119109,acute severe exacerbation of severe persistent allergic asthma (disorder),asthma
# SNOMED,10675551000119104,acute severe exacerbation of severe persistent asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10675591000119109,severe persistent allergic asthma controlled (finding),asthma
# SNOMED,10675631000119109,severe persistent asthma controlled co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10675671000119107,severe persistent allergic asthma uncontrolled (finding),asthma
# SNOMED,10675711000119106,severe persistent asthma uncontrolled co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10675751000119107,severe uncontrolled persistent asthma (disorder),asthma
# SNOMED,10675871000119106,mild persistent allergic asthma (disorder),asthma
# SNOMED,10675911000119109,acute severe exacerbation of mild persistent allergic asthma (disorder),asthma
# SNOMED,10675991000119100,acute severe exacerbation of mild persistent allergic asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10676031000119106,mild persistent allergic asthma controlled (finding),asthma
# SNOMED,10676071000119109,mild persistent asthma controlled (finding),asthma
# SNOMED,10676111000119102,mild persistent asthma controlled co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10676151000119101,mild persistent allergic asthma uncontrolled (finding),asthma
# SNOMED,10676191000119106,mild persistent asthma uncontrolled (finding),asthma
# SNOMED,10676231000119102,mild persistent asthma uncontrolled co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10676351000119103,moderate persistent asthma controlled (finding),asthma
# SNOMED,10676391000119108,moderate persistent allergic asthma (disorder),asthma
# SNOMED,10676431000119103,acute severe exacerbation of moderate persistent allergic asthma (disorder),asthma
# SNOMED,10676511000119109,acute severe exacerbation of moderate persistent asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10676551000119105,moderate persistent allergic asthma controlled (finding),asthma
# SNOMED,10676591000119100,moderate persistent controlled asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10676631000119100,moderate persistent allergic asthma uncontrolled (finding),asthma
# SNOMED,10676671000119102,moderate persistent asthma uncontrolled co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,10676711000119103,moderate persistent asthma uncontrolled (finding),asthma
# SNOMED,10692721000119102,chronic obstructive asthma co-occurrent with acute exacerbation of asthma (disorder),asthma
# SNOMED,10742121000119104,asthma in mother complicating childbirth (disorder),asthma
# SNOMED,1086701000000102,life threatening acute exacerbation of allergic asthma (disorder),asthma
# SNOMED,1086711000000100,life threatening acute exacerbation of intrinsic asthma (disorder),asthma
# SNOMED,1103911000000103,severe asthma with fungal sensitisation (disorder),asthma
# SNOMED,11641008,millers' asthma (disorder),asthma
# SNOMED,12428000,intrinsic asthma without status asthmaticus (disorder),asthma
# SNOMED,124991000119109,severe persistent asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,125001000119103,moderate persistent asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,125011000119100,mild persistent asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,125021000119107,intermittent asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,135171000119106,acute exacerbation of moderate persistent asthma (disorder),asthma
# SNOMED,135181000119109,acute exacerbation of mild persistent asthma (disorder),asthma
# SNOMED,16584951000119101,oral steroid-dependent asthma (disorder),asthma
# SNOMED,1741000119102,intermittent asthma uncontrolled (disorder),asthma
# SNOMED,1751000119100,acute exacerbation of chronic obstructive airways disease with asthma (disorder),asthma
# SNOMED,18041002,printers' asthma (disorder),asthma
# SNOMED,195949008,chronic asthmatic bronchitis (disorder),asthma
# SNOMED,195967001,asthma (disorder),asthma
# SNOMED,195977004,mixed asthma (disorder),asthma
# SNOMED,225057002,brittle asthma (disorder),asthma
# SNOMED,233679003,late onset asthma (disorder),asthma
# SNOMED,233683003,hay fever with asthma (disorder),asthma
# SNOMED,233688007,sulfite-induced asthma (disorder),asthma
# SNOMED,233691007,asthmatic pulmonary eosinophilia (disorder),asthma
# SNOMED,2360001000004109,steroid dependent asthma (disorder),asthma
# SNOMED,266361008,non-allergic asthma (disorder),asthma
# SNOMED,281239006,exacerbation of asthma (disorder),asthma
# SNOMED,30352005,allergic-infective asthma (disorder),asthma
# SNOMED,304527002,acute asthma (disorder),asthma
# SNOMED,312453004,asthma - currently active (finding),asthma
# SNOMED,31387002,exercise-induced asthma (disorder),asthma
# SNOMED,34015007,bakers' asthma (disorder),asthma
# SNOMED,370218001,mild asthma (disorder),asthma
# SNOMED,370219009,moderate asthma (disorder),asthma
# SNOMED,370220003,occasional asthma (disorder),asthma
# SNOMED,370221004,severe asthma (disorder),asthma
# SNOMED,389145006,allergic asthma (disorder),asthma
# SNOMED,395022009,asthma night-time symptoms (finding),asthma
# SNOMED,401000119107,asthma with irreversible airway obstruction (disorder),asthma
# SNOMED,401193004,asthma confirmed (situation),asthma
# SNOMED,404804003,platinum asthma (disorder),asthma
# SNOMED,404806001,cheese-makers' asthma (disorder),asthma
# SNOMED,404808000,isocyanate induced asthma (disorder),asthma
# SNOMED,405944004,asthmatic bronchitis (disorder),asthma
# SNOMED,407674008,aspirin-induced asthma (disorder),asthma
# SNOMED,409663006,cough variant asthma (disorder),asthma
# SNOMED,41553006,detergent asthma (disorder),asthma
# SNOMED,418395004,tea-makers' asthma (disorder),asthma
# SNOMED,423889005,non-immunoglobulin e mediated allergic asthma (disorder),asthma
# SNOMED,424199006,substance induced asthma (disorder),asthma
# SNOMED,424643009,immunoglobulin e-mediated allergic asthma (disorder),asthma
# SNOMED,425969006,exacerbation of intermittent asthma (disorder),asthma
# SNOMED,426656000,severe persistent asthma (disorder),asthma
# SNOMED,426979002,mild persistent asthma (disorder),asthma
# SNOMED,427295004,moderate persistent asthma (disorder),asthma
# SNOMED,427603009,intermittent asthma (disorder),asthma
# SNOMED,427679007,mild intermittent asthma (disorder),asthma
# SNOMED,442025000,acute exacerbation of chronic asthmatic bronchitis (disorder),asthma
# SNOMED,445427006,seasonal asthma (disorder),asthma
# SNOMED,55570000,asthma without status asthmaticus (disorder),asthma
# SNOMED,56968009,asthma caused by wood dust (disorder),asthma
# SNOMED,57607007,occupational asthma (disorder),asthma
# SNOMED,63088003,allergic asthma without status asthmaticus (disorder),asthma
# SNOMED,641000119106,intermittent asthma well controlled (finding),asthma
# SNOMED,703953004,allergic asthma caused by dermatophagoides pteronyssinus (disorder),asthma
# SNOMED,703954005,allergic asthma caused by dermatophagoides farinae (disorder),asthma
# SNOMED,707444001,uncomplicated asthma (disorder),asthma
# SNOMED,707445000,exacerbation of mild persistent asthma (disorder),asthma
# SNOMED,707446004,exacerbation of moderate persistent asthma (disorder),asthma
# SNOMED,707447008,exacerbation of severe persistent asthma (disorder),asthma
# SNOMED,707511009,uncomplicated mild persistent asthma (disorder),asthma
# SNOMED,707512002,uncomplicated moderate persistent asthma (disorder),asthma
# SNOMED,707513007,uncomplicated severe persistent asthma (disorder),asthma
# SNOMED,707979007,acute severe exacerbation of severe persistent asthma (disorder),asthma
# SNOMED,707980005,acute severe exacerbation of moderate persistent asthma (disorder),asthma
# SNOMED,707981009,acute severe exacerbation of mild persistent asthma (disorder),asthma
# SNOMED,708038006,acute exacerbation of asthma (disorder),asthma
# SNOMED,708090002,acute severe exacerbation of asthma (disorder),asthma
# SNOMED,708093000,acute exacerbation of immunoglobulin e-mediated allergic asthma (disorder),asthma
# SNOMED,708094006,acute exacerbation of intrinsic asthma (disorder),asthma
# SNOMED,708095007,acute severe exacerbation of immunoglobin e-mediated allergic asthma (disorder),asthma
# SNOMED,708096008,acute severe exacerbation of intrinsic asthma (disorder),asthma
# SNOMED,72301000119103,asthma in pregnancy (disorder),asthma
# SNOMED,733858005,acute severe refractory exacerbation of asthma (disorder),asthma
# SNOMED,734904007,life threatening acute exacerbation of asthma (disorder),asthma
# SNOMED,734905008,moderate acute exacerbation of asthma (disorder),asthma
# SNOMED,735587000,acute severe exacerbation of asthma co-occurrent and due to allergic asthma (disorder),asthma
# SNOMED,735588005,uncomplicated allergic asthma (disorder),asthma
# SNOMED,735589002,uncomplicated non-allergic asthma (disorder),asthma
# SNOMED,762521001,exacerbation of allergic asthma (disorder),asthma
# SNOMED,782513000,acute severe exacerbation of allergic asthma (disorder),asthma
# SNOMED,782520007,exacerbation of allergic asthma due to infection (disorder),asthma
# SNOMED,786836003,near fatal asthma (disorder),asthma
# SNOMED,866881000000101,chronic asthma with fixed airflow obstruction (disorder),asthma
# SNOMED,92807009,chemical-induced asthma (disorder),asthma
# SNOMED,93432008,drug-induced asthma (disorder),asthma
# SNOMED,99031000119107,acute exacerbation of asthma co-occurrent with allergic rhinitis (disorder),asthma
# SNOMED,183478001,emergency hospital admission for asthma (procedure),asthma
# SNOMED,708358003,emergency asthma admission since last encounter (situation),asthma
# SNOMED,443117005,asthma control test score (observable entity),asthma
# SNOMED,763077003,asthma control questionnaire score (observable entity),asthma
# SNOMED,905301000000103,childhood asthma control test score (observable entity),asthma
# SNOMED,366874008,number of asthma exacerbations in past year (observable entity),asthma
# SNOMED,1110841000000103,quality and outcomes framework asthma quality indicator-related care invitation (procedure),asthma
# SNOMED,185731000,asthma monitoring call first letter (procedure),asthma
# SNOMED,185732007,asthma monitoring call second letter (procedure),asthma
# SNOMED,185734008,asthma monitoring call third letter (procedure),asthma
# SNOMED,185735009,asthma monitoring call verbal invite (procedure),asthma
# SNOMED,185736005,asthma monitoring call telephone invite (procedure),asthma
# SNOMED,92161000000104,quality and outcomes framework asthma quality indicator-related care invitation using preferred method of communication (procedure),asthma
# SNOMED,928451000000107,asthma monitoring invitation short message service text message (procedure),asthma
# SNOMED,928511000000107,asthma monitoring invitation email (procedure),asthma
# SNOMED,959401000000101,asthma monitoring short message service text message first invitation (procedure),asthma
# SNOMED,959421000000105,asthma monitoring short message service text message second invitation (procedure),asthma
# SNOMED,959441000000103,asthma monitoring short message service text message third invitation (procedure),asthma
# SNOMED,716491000000100,excepted from asthma quality indicators - informed dissent (finding),asthma
# SNOMED,717291000000103,excepted from asthma quality indicators - patient unsuitable (finding),asthma
# SNOMED,1108701000000106,excepted from asthma quality indicators - service unavailable (finding),asthma
# SNOMED,162660004,asthma resolved (finding),asthma
# SNOMED,170631002,asthma disturbing sleep (finding),asthma
# SNOMED,170632009,asthma causing night waking (finding),asthma
# SNOMED,170633004,asthma disturbs sleep weekly (finding),asthma
# SNOMED,170634005,asthma disturbs sleep frequently (finding),asthma
# SNOMED,170635006,asthma not disturbing sleep (finding),asthma
# SNOMED,170636007,asthma never disturbs sleep (finding),asthma
# SNOMED,170637003,asthma limiting activities (finding),asthma
# SNOMED,170638008,asthma not limiting activities (finding),asthma
# SNOMED,170655007,asthma restricts exercise (finding),asthma
# SNOMED,170656008,asthma sometimes restricts exercise (finding),asthma
# SNOMED,170657004,asthma severely restricts exercise (finding),asthma
# SNOMED,170658009,asthma never restricts exercise (finding),asthma
# SNOMED,270442000,asthma monitoring check done (finding),asthma
# SNOMED,370202007,asthma causes daytime symptoms 1 to 2 times per month (finding),asthma
# SNOMED,370203002,asthma causes daytime symptoms 1 to 2 times per week (finding),asthma
# SNOMED,370204008,asthma causes daytime symptoms most days (finding),asthma
# SNOMED,370205009,asthma causes night symptoms 1 to 2 times per month (finding),asthma
# SNOMED,370206005,asthma limits walking on the flat (finding),asthma
# SNOMED,370207001,asthma limits walking up hills or stairs (finding),asthma
# SNOMED,370208006,asthma never causes daytime symptoms (finding),asthma
# SNOMED,373899003,asthma daytime symptoms (finding),asthma
# SNOMED,390872009,change in asthma management plan (regime/therapy),asthma
# SNOMED,390877003,step up change in asthma management plan (regime/therapy),asthma
# SNOMED,390878008,step down change in asthma management plan (regime/therapy),asthma
# SNOMED,390921001,absent from work or school due to asthma (finding),asthma
# SNOMED,394700004,asthma annual review (regime/therapy),asthma
# SNOMED,394701000,asthma follow-up (regime/therapy),asthma
# SNOMED,394720003,asthma medication review (procedure),asthma
# SNOMED,401182001,asthma monitoring by nurse (regime/therapy),asthma
# SNOMED,401183006,asthma monitoring by doctor (regime/therapy),asthma
# SNOMED,473391009,asthma never causes night symptoms (situation),asthma
# SNOMED,754061000000100,asthma review using royal college of physicians three questions (regime/therapy),asthma
# SNOMED,771901000000100,asthma causes night time symptoms 1 to 2 times per week (finding),asthma
# SNOMED,771941000000102,asthma causes symptoms most nights (finding),asthma
# SNOMED,771981000000105,asthma limits activities 1 to 2 times per month (finding),asthma
# SNOMED,772011000000107,asthma limits activities 1 to 2 times per week (finding),asthma
# SNOMED,772051000000106,asthma limits activities most days (finding),asthma
# SNOMED,811151000000105,number of days absent from school due to asthma in past 6 months (observable entity),asthma
# SNOMED,527171000000103,patient has a written asthma personal action plan (finding),asthma
# SNOMED,810901000000102,asthma self-management plan review (procedure),asthma
# SNOMED,811921000000103,asthma self-management plan agreed (finding),asthma
# SNOMED,10674991000119104,intermittent allergic asthma (disorder),asthma
# SNOMED,829976001,thunderstorm asthma (disorder),asthma
# SNOMED,782559003,asthma never causes night symptoms (finding),asthma
# SNOMED,233748006,simple pneumoconiosis (disorder),ILD
# SNOMED,233749003,complicated pneumoconiosis (disorder),ILD
# SNOMED,233750003,erionite pneumoconiosis (disorder),ILD
# SNOMED,233751004,metal pneumoconiosis (disorder),ILD
# SNOMED,233754007,cerium pneumoconiosis (disorder),ILD
# SNOMED,233755008,nickel pneumoconiosis (disorder),ILD
# SNOMED,233756009,thorium pneumoconiosis (disorder),ILD
# SNOMED,233757000,zirconium pneumoconiosis (disorder),ILD
# SNOMED,233758005,mica pneumoconiosis (disorder),ILD
# SNOMED,233759002,mixed mineral dust pneumoconiosis (disorder),ILD
# SNOMED,233761006,subacute silicosis (disorder),ILD
# SNOMED,233762004,chronic silicosis (disorder),ILD
# SNOMED,233764003,wollastonite pneumoconiosis (disorder),ILD
# SNOMED,26511004,pneumoconiosis caused by sisal fiber (disorder),ILD
# SNOMED,29422001,coal workers' pneumoconiosis (disorder),ILD
# SNOMED,32139003,mixed dust pneumoconiosis (disorder),ILD
# SNOMED,398640008,rheumatoid pneumoconiosis (disorder),ILD
# SNOMED,40122008,pneumoconiosis (disorder),ILD
# SNOMED,40218008,carbon electrode makers' pneumoconiosis (disorder),ILD
# SNOMED,426853005,pneumoconiosis caused by silicate (disorder),ILD
# SNOMED,58691003,antimony pneumoconiosis (disorder),ILD
# SNOMED,73144008,pneumoconiosis caused by talc (disorder),ILD
# SNOMED,805002,pneumoconiosis caused by silica (disorder),ILD
# SNOMED,87909002,hard metal pneumoconiosis (disorder),ILD
# SNOMED,32544004,chronic obliterative bronchiolitis caused by inhalation of chemical fumes and/or vapors (disorder),ILD
# SNOMED,37711000,cadmium pneumonitis (disorder),ILD
# SNOMED,47515009,simple silicosis (disorder),ILD
# SNOMED,8549006,desquamative interstitial pneumonia (disorder),ILD
# SNOMED,236302005,acute interstitial pneumonia (disorder),ILD
# SNOMED,35037009,primary atypical interstitial pneumonia (disorder),ILD
# SNOMED,385479009,follicular bronchiolitis (disorder),ILD
# SNOMED,4120002,bronchiolitis (disorder),ILD
# SNOMED,430476004,diffuse panbronchiolitis (disorder),ILD
# SNOMED,59903001,acute obliterating bronchiolitis (disorder),ILD
# SNOMED,64667001,interstitial pneumonia (disorder),ILD
# SNOMED,704345008,chronic interstitial pneumonia (disorder),ILD
# SNOMED,10713006,diffuse interstitial rheumatoid disease of lung (disorder),ILD
# SNOMED,129452008,nonspecific interstitial pneumonia (disorder),ILD
# SNOMED,196051003,drug-induced interstitial lung disorder (disorder),ILD
# SNOMED,196133001,lung disease with systemic sclerosis (disorder),ILD
# SNOMED,233692000,cryptogenic pulmonary eosinophilia (disorder),ILD
# SNOMED,233770009,stage 4 pulmonary sarcoidosis (disorder),ILD
# SNOMED,24369008,pulmonary sarcoidosis (disorder),ILD
# SNOMED,30042003,confluent fibrosis of lung (disorder),ILD
# SNOMED,34371004,subacute obliterative bronchiolitis caused by inhalation of chemical fumes and/or vapors (disorder),ILD
# SNOMED,3514002,peribronchial fibrosis of lung (disorder),ILD
# SNOMED,405570007,pulmonary fibrosis due to and following radiotherapy (disorder),ILD
# SNOMED,427046006,drug-induced pneumonitis (disorder),ILD
# SNOMED,54867000,rheumatoid fibrosing alveolitis (disorder),ILD
# SNOMED,56841008,massive fibrosis of lung (disorder),ILD
# SNOMED,700249006,idiopathic interstitial pneumonia (disorder),ILD
# SNOMED,707434003,pulmonary fibrosis due to hermansky-pudlak syndrome (disorder),ILD
# SNOMED,719218000,cryptogenic organizing pneumonia (disorder),ILD
# SNOMED,733453005,"congenital nephrotic syndrome, interstitial lung disease, epidermolysis bullosa syndrome (disorder)",ILD
# SNOMED,737181009,interstitial lung disease due to systemic disease (disorder),ILD
# SNOMED,737182002,interstitial lung disease due to granulomatous disease (disorder),ILD
# SNOMED,737183007,interstitial lung disease due to metabolic disease (disorder),ILD
# SNOMED,737184001,interstitial lung disease co-occurrent and due to systemic vasculitis (disorder),ILD
# SNOMED,155621007,rheumatoid lung (disorder),ILD
# SNOMED,196132006,rheumatoid lung (disorder),ILD
# SNOMED,201794001,rheumatoid lung (disorder),ILD
# SNOMED,201813004,(rheumatoid lung) or (caplan's syndrome) or (fibrosing alveolitis associated with rheumatoid arthritis) (disorder),ILD
# SNOMED,239794002,fibrosing alveolitis associated with rheumatoid arthritis (disorder),ILD
# SNOMED,319841000119107,rheumatoid lung disease with rheumatoid arthritis (disorder),ILD
# SNOMED,398726004,rheumatoid lung disease (disorder),ILD
# SNOMED,129451001,respiratory bronchiolitis associated interstitial lung disease (disorder),ILD
# SNOMED,129458007,bronchiolitis obliterans organizing pneumonia (disorder),ILD
# SNOMED,14700006,bauxite fibrosis of lung (disorder),ILD
# SNOMED,17385007,graphite fibrosis of lung (disorder),ILD
# SNOMED,17996008,pneumoconiosis caused by inorganic dust (disorder),ILD
# SNOMED,192658007,giant cell interstitial pneumonitis (disorder),ILD
# SNOMED,196027008,toxic bronchiolitis obliterans (disorder),ILD
# SNOMED,196053000,chronic drug-induced interstitial lung disorders (disorder),ILD
# SNOMED,196125002,diffuse interstitial pulmonary fibrosis (disorder),ILD
# SNOMED,22607003,asbestosis (disorder),ILD
# SNOMED,233673002,drug-induced bronchiolitis obliterans (disorder),ILD
# SNOMED,233703007,interstitial lung disease (disorder),ILD
# SNOMED,233713004,seasonal cryptogenic organizing pneumonia with biochemical cholestasis (disorder),ILD
# SNOMED,233723008,bronchiolitis obliterans with usual interstitial pneumonitis (disorder),ILD
# SNOMED,233724002,toxic diffuse interstitial pulmonary fibrosis (disorder),ILD
# SNOMED,233725001,drug-induced diffuse interstitial pulmonary fibrosis (disorder),ILD
# SNOMED,233760007,acute silicosis (disorder),ILD
# SNOMED,277844007,pulmonary lymphangioleiomyomatosis (disorder),ILD
# SNOMED,36599006,chronic fibrosis of lung (disorder),ILD
# SNOMED,40100001,obliterative bronchiolitis (disorder),ILD
# SNOMED,40527005,idiopathic pulmonary hemosiderosis (disorder),ILD
# SNOMED,40640008,massive fibrosis of lung co-occurrent and due to silicosis (disorder),ILD
# SNOMED,427123006,interstitial lung disease due to collagen vascular disease (disorder),ILD
# SNOMED,44274007,lymphoid interstitial pneumonia (disorder),ILD
# SNOMED,47938003,chronic obliterative bronchiolitis (disorder),ILD
# SNOMED,51615001,fibrosis of lung (disorder),ILD
# SNOMED,62371005,pulmonary siderosis (disorder),ILD
# SNOMED,711379004,interstitial lung disease due to connective tissue disease (disorder),ILD
# SNOMED,71193007,fibrosis of lung caused by radiation (disorder),ILD
# SNOMED,72270005,collagenous pneumoconiosis (disorder),ILD
# SNOMED,196136009,lung disease co-occurrent with polymyositis (disorder),ILD
# SNOMED,836478002,subacute obliterative bronchiolitis caused by chemical fumes (disorder),ILD
# SNOMED,836479005,subacute obliterative bronchiolitis caused by vapor (disorder),ILD
# SNOMED,840350008,chronic obliterative bronchiolitis caused by chemical fumes (disorder),ILD
# SNOMED,840351007,chronic obliterative bronchiolitis caused by vapor (disorder),ILD
# SNOMED,866103007,interstitial lung disease due to juvenile polymyositis (disorder),ILD
# SNOMED,239297008,lymphomatoid granulomatosis of lung (disorder),ILD
# SNOMED,870573008,interstitial pneumonia with autoimmune features (disorder),ILD
# SNOMED,1017196003,interstitial pulmonary fibrosis due to inhalation of substance (disorder),ILD
# SNOMED,1017197007,interstitial pulmonary fibrosis due to inhalation of drug (disorder),ILD
# SNOMED,700252003,subacute idiopathic pulmonary fibrosis (disorder),ILD
# SNOMED,708537005,acute idiopathic pulmonary fibrosis (disorder),ILD
# SNOMED,426437004,familial idiopathic pulmonary fibrosis (disorder),ILD
# SNOMED,700250006,idiopathic pulmonary fibrosis (disorder),ILD
# SNOMED,700251005,chronic idiopathic pulmonary fibrosis (disorder),ILD
# SNOMED,789574002,acute exacerbation of idiopathic pulmonary fibrosis (disorder),ILD
# """
# codelist = (
#   spark.createDataFrame(
#     pd.DataFrame(pd.read_csv(io.StringIO(codelist_hw)))
#     .fillna('')
#     .astype(str)
#   )
#   .withColumn('name', f.when(f.col('name') == 'copd', 'COPD').otherwise(f.col('name')))
#   .orderBy('name', 'terminology', 'code')
# )

# # temp save 
# # as this will be accessed by data_check\CCU003_05-D02b-codelist_exposures_and_outcomes_comparison
# # saving here so that we only have one version of the import to keep track of
# # codelist_lcp = temp_save(df=codelist_lcp, out_name=f'{proj}_tmp_codelist_exp_out_lcp'); print()

# COMMAND ----------

codelist_hw = spark.createDataFrame([
("copd","SNOMED","106001000119101","chronic obstructive lung disease co-occurrent with acute bronchitis (disorder)","1","20220215"),
("copd","SNOMED","135836000","end stage chronic obstructive airways disease (disorder)","1","20220215"),
("copd","SNOMED","13645005","chronic obstructive lung disease (disorder)","1","20220215"),
("copd","SNOMED","16003001","giant bullous emphysema (disorder)","1","20220215"),
("copd","SNOMED","16846004","obstructive emphysema (disorder)","1","20220215"),
("copd","SNOMED","185086009","chronic obstructive bronchitis (disorder)","1","20220215"),
("copd","SNOMED","195951007","acute exacerbation of chronic obstructive airways disease (disorder)","1","20220215"),
("copd","SNOMED","195958001","segmental bullous emphysema (disorder)","1","20220215"),
("copd","SNOMED","195959009","zonal bullous emphysema (disorder)","1","20220215"),
("copd","SNOMED","196001008","chronic obstructive pulmonary disease with acute lower respiratory infection (disorder)","1","20220215"),
("copd","SNOMED","233674008","pulmonary emphysema in alpha-1 primary immunodeficiency deficiency (disorder)","1","20220215"),
("copd","SNOMED","266355005","bullous emphysema with collapse (disorder)","1","20220215"),
("copd","SNOMED","285381006","acute infective exacerbation of chronic obstructive airways disease (disorder)","1","20220215"),
("copd","SNOMED","293241000119100","acute exacerbation of chronic obstructive bronchitis (disorder)","1","20220215"),
("copd","SNOMED","293991000000106","very severe chronic obstructive pulmonary disease (disorder)","1","20220215"),
("copd","SNOMED","313296004","mild chronic obstructive pulmonary disease (disorder)","1","20220215"),
("copd","SNOMED","313297008","moderate chronic obstructive pulmonary disease (disorder)","1","20220215"),
("copd","SNOMED","313299006","severe chronic obstructive pulmonary disease (disorder)","1","20220215"),
("copd","SNOMED","31898008","paraseptal emphysema (disorder)","1","20220215"),
("copd","SNOMED","45145000","unilateral emphysema (situation)","1","20220215"),
("copd","SNOMED","4981000","panacinar emphysema (disorder)","1","20220215"),
("copd","SNOMED","66110007","chronic diffuse emphysema caused by inhalation of chemical fumes and/or vapors (disorder)","1","20220215"),
("copd","SNOMED","68328006","centriacinar emphysema (disorder)","1","20220215"),
("copd","SNOMED","847091000000104","acute non-infective exacerbation of chronic obstructive pulmonary disease (disorder)","1","20220215"),
("copd","SNOMED","87433001","pulmonary emphysema (disorder)","1","20220215"),
("copd","SNOMED","408501008","emergency hospital admission for chronic obstructive pulmonary disease (procedure)","1","20220215"),
("copd","SNOMED","1110861000000102","quality and outcomes framework chronic obstructive pulmonary disease quality indicator-related care invitation (procedure)","1","20220215"),
("copd","SNOMED","143371000000104","quality and outcomes framework chronic obstructive pulmonary disease quality indicator-related care invitation using preferred method of communication (procedure)","1","20220215"),
("copd","SNOMED","836477007","chronic emphysema caused by vapor (disorder)","1","20220215"),
("copd","SNOMED","1010333003","emphysema of left lung (disorder)","1","20220215"),
("copd","SNOMED","1010334009","emphysema of right lung (disorder)","1","20220215"),  
("copd","SNOMED","63480004","chronic bronchitis (disorder)","1","20230519"), # added in (email 20230519)
("copd", "ICD10", "J41.0", "Simple chronic bronchitis", "1", "20230803"), # added in 20230822
("copd", "ICD10", "J42", "Unspecified chronic bronchitis", "1", "20230803"), 
("copd", "ICD10", "J43", "Emphysema", "1", "20230803"), 
("copd", "ICD10", "J43.1", "Panlobular emphysema", "1", "20230803"), 
("copd", "ICD10", "J43.2", "Centrilobular emphysema", "1", "20230803"), 
("copd", "ICD10", "J43.8", "Other emphysema", "1", "20230803"), 
("copd", "ICD10", "J43.9", "Emphysema, unspecified", "1", "20230803"), 
("copd", "ICD10", "J44", "Other chronic obstructive pulmonary disease", "1", "20230803"), 
("copd", "ICD10", "J44.0", "Chronic obstructive pulmonary disease with acute lower respiratory infection", "1", "20230803"), 
("copd", "ICD10", "J44.1", "Chronic obstructive pulmonary disease with acute exacerbation, unspecified", "1", "20230803"), 
("copd", "ICD10", "J44.8", "Other specified chronic obstructive pulmonary disease", "1", "20230803"), 
("copd", "ICD10", "J44.9", "Chronic obstructive pulmonary disease, unspecified", "1", "20230803"),

("asthma","SNOMED","1064811000000103","moderate acute exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","1064821000000109","life threatening acute exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","10674711000119105","acute severe exacerbation of asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10675391000119101","severe controlled persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","10675431000119106","severe persistent allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","10675471000119109","acute severe exacerbation of severe persistent allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","10675551000119104","acute severe exacerbation of severe persistent asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10675591000119109","severe persistent allergic asthma controlled (finding)","1","20220215"),
("asthma","SNOMED","10675631000119109","severe persistent asthma controlled co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10675671000119107","severe persistent allergic asthma uncontrolled (finding)","1","20220215"),
("asthma","SNOMED","10675711000119106","severe persistent asthma uncontrolled co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10675751000119107","severe uncontrolled persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","10675871000119106","mild persistent allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","10675911000119109","acute severe exacerbation of mild persistent allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","10675991000119100","acute severe exacerbation of mild persistent allergic asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10676031000119106","mild persistent allergic asthma controlled (finding)","1","20220215"),
("asthma","SNOMED","10676071000119109","mild persistent asthma controlled (finding)","1","20220215"),
("asthma","SNOMED","10676111000119102","mild persistent asthma controlled co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10676151000119101","mild persistent allergic asthma uncontrolled (finding)","1","20220215"),
("asthma","SNOMED","10676191000119106","mild persistent asthma uncontrolled (finding)","1","20220215"),
("asthma","SNOMED","10676231000119102","mild persistent asthma uncontrolled co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10676351000119103","moderate persistent asthma controlled (finding)","1","20220215"),
("asthma","SNOMED","10676391000119108","moderate persistent allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","10676431000119103","acute severe exacerbation of moderate persistent allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","10676511000119109","acute severe exacerbation of moderate persistent asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10676551000119105","moderate persistent allergic asthma controlled (finding)","1","20220215"),
("asthma","SNOMED","10676591000119100","moderate persistent controlled asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10676631000119100","moderate persistent allergic asthma uncontrolled (finding)","1","20220215"),
("asthma","SNOMED","10676671000119102","moderate persistent asthma uncontrolled co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","10676711000119103","moderate persistent asthma uncontrolled (finding)","1","20220215"),
("asthma","SNOMED","10692721000119102","chronic obstructive asthma co-occurrent with acute exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","1086701000000102","life threatening acute exacerbation of allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","1086711000000100","life threatening acute exacerbation of intrinsic asthma (disorder)","1","20220215"),
("asthma","SNOMED","1103911000000103","severe asthma with fungal sensitisation (disorder)","1","20220215"),
("asthma","SNOMED","11641008","millers' asthma (disorder)","1","20220215"),
("asthma","SNOMED","12428000","intrinsic asthma without status asthmaticus (disorder)","1","20220215"),
("asthma","SNOMED","124991000119109","severe persistent asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","125001000119103","moderate persistent asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","125011000119100","mild persistent asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","125021000119107","intermittent asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","135171000119106","acute exacerbation of moderate persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","135181000119109","acute exacerbation of mild persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","16584951000119101","oral steroid-dependent asthma (disorder)","1","20220215"),
("asthma","SNOMED","1741000119102","intermittent asthma uncontrolled (disorder)","1","20220215"),
("asthma","SNOMED","1751000119100","acute exacerbation of chronic obstructive airways disease with asthma (disorder)","1","20220215"),
("asthma","SNOMED","18041002","printers' asthma (disorder)","1","20220215"),
("asthma","SNOMED","195967001","asthma (disorder)","1","20220215"),
("asthma","SNOMED","195977004","mixed asthma (disorder)","1","20220215"),
("asthma","SNOMED","225057002","brittle asthma (disorder)","1","20220215"),
("asthma","SNOMED","233679003","late onset asthma (disorder)","1","20220215"),
("asthma","SNOMED","233683003","hay fever with asthma (disorder)","1","20220215"),
("asthma","SNOMED","233688007","sulfite-induced asthma (disorder)","1","20220215"),
("asthma","SNOMED","233691007","asthmatic pulmonary eosinophilia (disorder)","1","20220215"),
("asthma","SNOMED","2360001000004109","steroid dependent asthma (disorder)","1","20220215"),
("asthma","SNOMED","266361008","non-allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","281239006","exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","30352005","allergic-infective asthma (disorder)","1","20220215"),
("asthma","SNOMED","304527002","acute asthma (disorder)","1","20220215"),
("asthma","SNOMED","312453004","asthma - currently active (finding)","1","20220215"),
("asthma","SNOMED","31387002","exercise-induced asthma (disorder)","1","20220215"),
("asthma","SNOMED","34015007","bakers' asthma (disorder)","1","20220215"),
("asthma","SNOMED","370218001","mild asthma (disorder)","1","20220215"),
("asthma","SNOMED","370219009","moderate asthma (disorder)","1","20220215"),
("asthma","SNOMED","370220003","occasional asthma (disorder)","1","20220215"),
("asthma","SNOMED","370221004","severe asthma (disorder)","1","20220215"),
("asthma","SNOMED","389145006","allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","395022009","asthma night-time symptoms (finding)","1","20220215"),
("asthma","SNOMED","401000119107","asthma with irreversible airway obstruction (disorder)","1","20220215"),
("asthma","SNOMED","401193004","asthma confirmed (situation)","1","20220215"),
("asthma","SNOMED","404804003","platinum asthma (disorder)","1","20220215"),
("asthma","SNOMED","404806001","cheese-makers' asthma (disorder)","1","20220215"),
("asthma","SNOMED","404808000","isocyanate induced asthma (disorder)","1","20220215"),
("asthma","SNOMED","405944004","asthmatic bronchitis (disorder)","1","20220215"),
# ("asthma","SNOMED","407674008","aspirin-induced asthma (disorder)","1","20220215"), # commented out (email 20230519)
("asthma","SNOMED","409663006","cough variant asthma (disorder)","1","20220215"),
("asthma","SNOMED","41553006","detergent asthma (disorder)","1","20220215"),
("asthma","SNOMED","418395004","tea-makers' asthma (disorder)","1","20220215"),
("asthma","SNOMED","423889005","non-immunoglobulin e mediated allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","424199006","substance induced asthma (disorder)","1","20220215"),
("asthma","SNOMED","424643009","immunoglobulin e-mediated allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","425969006","exacerbation of intermittent asthma (disorder)","1","20220215"),
("asthma","SNOMED","426656000","severe persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","426979002","mild persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","427295004","moderate persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","427603009","intermittent asthma (disorder)","1","20220215"),
("asthma","SNOMED","427679007","mild intermittent asthma (disorder)","1","20220215"),
("asthma","SNOMED","442025000","acute exacerbation of chronic asthmatic bronchitis (disorder)","1","20220215"),
("asthma","SNOMED","445427006","seasonal asthma (disorder)","1","20220215"),
("asthma","SNOMED","55570000","asthma without status asthmaticus (disorder)","1","20220215"),
("asthma","SNOMED","56968009","asthma caused by wood dust (disorder)","1","20220215"),
("asthma","SNOMED","57607007","occupational asthma (disorder)","1","20220215"),
("asthma","SNOMED","63088003","allergic asthma without status asthmaticus (disorder)","1","20220215"),
("asthma","SNOMED","641000119106","intermittent asthma well controlled (finding)","1","20220215"),
("asthma","SNOMED","703953004","allergic asthma caused by dermatophagoides pteronyssinus (disorder)","1","20220215"),
("asthma","SNOMED","703954005","allergic asthma caused by dermatophagoides farinae (disorder)","1","20220215"),
("asthma","SNOMED","707444001","uncomplicated asthma (disorder)","1","20220215"),
("asthma","SNOMED","707445000","exacerbation of mild persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","707446004","exacerbation of moderate persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","707447008","exacerbation of severe persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","707511009","uncomplicated mild persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","707512002","uncomplicated moderate persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","707513007","uncomplicated severe persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","707979007","acute severe exacerbation of severe persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","707980005","acute severe exacerbation of moderate persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","707981009","acute severe exacerbation of mild persistent asthma (disorder)","1","20220215"),
("asthma","SNOMED","708038006","acute exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","708090002","acute severe exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","708093000","acute exacerbation of immunoglobulin e-mediated allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","708094006","acute exacerbation of intrinsic asthma (disorder)","1","20220215"),
("asthma","SNOMED","708095007","acute severe exacerbation of immunoglobin e-mediated allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","708096008","acute severe exacerbation of intrinsic asthma (disorder)","1","20220215"),
("asthma","SNOMED","72301000119103","asthma in pregnancy (disorder)","1","20220215"),
("asthma","SNOMED","733858005","acute severe refractory exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","734904007","life threatening acute exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","734905008","moderate acute exacerbation of asthma (disorder)","1","20220215"),
("asthma","SNOMED","735587000","acute severe exacerbation of asthma co-occurrent and due to allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","735588005","uncomplicated allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","735589002","uncomplicated non-allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","762521001","exacerbation of allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","782513000","acute severe exacerbation of allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","782520007","exacerbation of allergic asthma due to infection (disorder)","1","20220215"),
("asthma","SNOMED","786836003","near fatal asthma (disorder)","1","20220215"),
("asthma","SNOMED","866881000000101","chronic asthma with fixed airflow obstruction (disorder)","1","20220215"),
("asthma","SNOMED","92807009","chemical-induced asthma (disorder)","1","20220215"),
("asthma","SNOMED","93432008","drug-induced asthma (disorder)","1","20220215"),
("asthma","SNOMED","99031000119107","acute exacerbation of asthma co-occurrent with allergic rhinitis (disorder)","1","20220215"),
("asthma","SNOMED","183478001","emergency hospital admission for asthma (procedure)","1","20220215"),
("asthma","SNOMED","708358003","emergency asthma admission since last encounter (situation)","1","20220215"),
("asthma","SNOMED","170631002","asthma disturbing sleep (finding)","1","20220215"),
("asthma","SNOMED","170632009","asthma causing night waking (finding)","1","20220215"),
("asthma","SNOMED","170633004","asthma disturbs sleep weekly (finding)","1","20220215"),
("asthma","SNOMED","170634005","asthma disturbs sleep frequently (finding)","1","20220215"),
("asthma","SNOMED","170635006","asthma not disturbing sleep (finding)","1","20220215"),
("asthma","SNOMED","170636007","asthma never disturbs sleep (finding)","1","20220215"),
("asthma","SNOMED","170637003","asthma limiting activities (finding)","1","20220215"),
("asthma","SNOMED","170638008","asthma not limiting activities (finding)","1","20220215"),
("asthma","SNOMED","170655007","asthma restricts exercise (finding)","1","20220215"),
("asthma","SNOMED","170656008","asthma sometimes restricts exercise (finding)","1","20220215"),
("asthma","SNOMED","170657004","asthma severely restricts exercise (finding)","1","20220215"),
("asthma","SNOMED","170658009","asthma never restricts exercise (finding)","1","20220215"),
("asthma","SNOMED","270442000","asthma monitoring check done (finding)","1","20220215"),
("asthma","SNOMED","370202007","asthma causes daytime symptoms 1 to 2 times per month (finding)","1","20220215"),
("asthma","SNOMED","370203002","asthma causes daytime symptoms 1 to 2 times per week (finding)","1","20220215"),
("asthma","SNOMED","370204008","asthma causes daytime symptoms most days (finding)","1","20220215"),
("asthma","SNOMED","370205009","asthma causes night symptoms 1 to 2 times per month (finding)","1","20220215"),
("asthma","SNOMED","370206005","asthma limits walking on the flat (finding)","1","20220215"),
("asthma","SNOMED","370207001","asthma limits walking up hills or stairs (finding)","1","20220215"),
("asthma","SNOMED","370208006","asthma never causes daytime symptoms (finding)","1","20220215"),
("asthma","SNOMED","373899003","asthma daytime symptoms (finding)","1","20220215"),
("asthma","SNOMED","390872009","change in asthma management plan (regime/therapy)","1","20220215"),
("asthma","SNOMED","390877003","step up change in asthma management plan (regime/therapy)","1","20220215"),
("asthma","SNOMED","390878008","step down change in asthma management plan (regime/therapy)","1","20220215"),
("asthma","SNOMED","390921001","absent from work or school due to asthma (finding)","1","20220215"),
("asthma","SNOMED","394700004","asthma annual review (regime/therapy)","1","20220215"),
("asthma","SNOMED","473391009","asthma never causes night symptoms (situation)","1","20220215"),
("asthma","SNOMED","771901000000100","asthma causes night time symptoms 1 to 2 times per week (finding)","1","20220215"),
("asthma","SNOMED","771941000000102","asthma causes symptoms most nights (finding)","1","20220215"),
("asthma","SNOMED","771981000000105","asthma limits activities 1 to 2 times per month (finding)","1","20220215"),
("asthma","SNOMED","772011000000107","asthma limits activities 1 to 2 times per week (finding)","1","20220215"),
("asthma","SNOMED","772051000000106","asthma limits activities most days (finding)","1","20220215"),
("asthma","SNOMED","811151000000105","number of days absent from school due to asthma in past 6 months (observable entity)","1","20220215"),
("asthma","SNOMED","10674991000119104","intermittent allergic asthma (disorder)","1","20220215"),
("asthma","SNOMED","829976001","thunderstorm asthma (disorder)","1","20220215"),
("asthma","SNOMED","782559003","asthma never causes night symptoms (finding)","1","20220215"),
("asthma", "ICD10", "J45", "Asthma", "1", "20230803"), # added in 20230822
("asthma", "ICD10", "J45.0", "Extrinsic asthma", "1", "20230803"), 
("asthma", "ICD10", "J45.1", "Intrinsic asthma", "1", "20230803"), 
("asthma", "ICD10", "J45.20", "Mild intermittent asthma, uncomplicated", "1", "20230803"), 
("asthma", "ICD10", "J45.21", "Mild intermittent asthma with (acute) exacerbation", "1", "20230803"), 
("asthma", "ICD10", "J45.30", "Mild persistent asthma, uncomplicated", "1", "20230803"), 
("asthma", "ICD10", "J45.31", "Mild persistent asthma with (acute) exacerbation", "1", "20230803"), 
("asthma", "ICD10", "J45.40", "Moderate persistent asthma, uncomplicated", "1", "20230803"), 
("asthma", "ICD10", "J45.41", "Moderate persistent asthma with (acute) exacerbation", "1", "20230803"), 
("asthma", "ICD10", "J45.50", "Severe persistent asthma, uncomplicated", "1", "20230803"), 
("asthma", "ICD10", "J45.51", "Severe persistent asthma with (acute) exacerbation", "1", "20230803"), 
("asthma", "ICD10", "J45.8", "Chronic obstructive asthma", "1", "20230803"), 
("asthma", "ICD10", "J45.9", "Other forms of asthma", "1", "20230803"), 
("asthma", "ICD10", "J45.901", "Unspecified asthma with (acute) exacerbation", "1", "20230803"), 
("asthma", "ICD10", "J45.909", "Unspecified asthma, uncomplicated", "1", "20230803"), 
("asthma", "ICD10", "J45.998", "Other asthma", "1", "20230803"), 
("asthma", "ICD10", "J46", "Status asthmaticus", "1", "20230803"),

("ILD","SNOMED","233748006","simple pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233749003","complicated pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233750003","erionite pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233751004","metal pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233754007","cerium pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233755008","nickel pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233756009","thorium pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233757000","zirconium pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233758005","mica pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233759002","mixed mineral dust pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","233761006","subacute silicosis (disorder)","1","20220215"),
("ILD","SNOMED","233762004","chronic silicosis (disorder)","1","20220215"),
("ILD","SNOMED","233764003","wollastonite pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","26511004","pneumoconiosis caused by sisal fiber (disorder)","1","20220215"),
("ILD","SNOMED","29422001","coal workers' pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","32139003","mixed dust pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","398640008","rheumatoid pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","40122008","pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","40218008","carbon electrode makers' pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","426853005","pneumoconiosis caused by silicate (disorder)","1","20220215"),
("ILD","SNOMED","58691003","antimony pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","73144008","pneumoconiosis caused by talc (disorder)","1","20220215"),
("ILD","SNOMED","805002","pneumoconiosis caused by silica (disorder)","1","20220215"),
("ILD","SNOMED","87909002","hard metal pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","32544004","chronic obliterative bronchiolitis caused by inhalation of chemical fumes and/or vapors (disorder)","1","20220215"),
("ILD","SNOMED","37711000","cadmium pneumonitis (disorder)","1","20220215"),
("ILD","SNOMED","47515009","simple silicosis (disorder)","1","20220215"),
("ILD","SNOMED","8549006","desquamative interstitial pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","236302005","acute interstitial pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","35037009","primary atypical interstitial pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","385479009","follicular bronchiolitis (disorder)","1","20220215"),
("ILD","SNOMED","430476004","diffuse panbronchiolitis (disorder)","1","20220215"),
("ILD","SNOMED","59903001","acute obliterating bronchiolitis (disorder)","1","20220215"),
("ILD","SNOMED","64667001","interstitial pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","704345008","chronic interstitial pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","10713006","diffuse interstitial rheumatoid disease of lung (disorder)","1","20220215"),
("ILD","SNOMED","129452008","nonspecific interstitial pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","196051003","drug-induced interstitial lung disorder (disorder)","1","20220215"),
("ILD","SNOMED","196133001","lung disease with systemic sclerosis (disorder)","1","20220215"),
("ILD","SNOMED","233692000","cryptogenic pulmonary eosinophilia (disorder)","1","20220215"),
("ILD","SNOMED","233770009","stage 4 pulmonary sarcoidosis (disorder)","1","20220215"),
("ILD","SNOMED","24369008","pulmonary sarcoidosis (disorder)","1","20220215"),
("ILD","SNOMED","30042003","confluent fibrosis of lung (disorder)","1","20220215"),
("ILD","SNOMED","34371004","subacute obliterative bronchiolitis caused by inhalation of chemical fumes and/or vapors (disorder)","1","20220215"),
("ILD","SNOMED","3514002","peribronchial fibrosis of lung (disorder)","1","20220215"),
("ILD","SNOMED","405570007","pulmonary fibrosis due to and following radiotherapy (disorder)","1","20220215"),
("ILD","SNOMED","427046006","drug-induced pneumonitis (disorder)","1","20220215"),
("ILD","SNOMED","54867000","rheumatoid fibrosing alveolitis (disorder)","1","20220215"),
("ILD","SNOMED","56841008","massive fibrosis of lung (disorder)","1","20220215"),
("ILD","SNOMED","700249006","idiopathic interstitial pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","707434003","pulmonary fibrosis due to hermansky-pudlak syndrome (disorder)","1","20220215"),
("ILD","SNOMED","719218000","cryptogenic organizing pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","737181009","interstitial lung disease due to systemic disease (disorder)","1","20220215"),
("ILD","SNOMED","737182002","interstitial lung disease due to granulomatous disease (disorder)","1","20220215"),
("ILD","SNOMED","737183007","interstitial lung disease due to metabolic disease (disorder)","1","20220215"),
("ILD","SNOMED","737184001","interstitial lung disease co-occurrent and due to systemic vasculitis (disorder)","1","20220215"),
("ILD","SNOMED","155621007","rheumatoid lung (disorder)","1","20220215"),
("ILD","SNOMED","196132006","rheumatoid lung (disorder)","1","20220215"),
("ILD","SNOMED","201794001","rheumatoid lung (disorder)","1","20220215"),
("ILD","SNOMED","201813004","(rheumatoid lung) or (caplan's syndrome) or (fibrosing alveolitis associated with rheumatoid arthritis) (disorder)","1","20220215"),
("ILD","SNOMED","239794002","fibrosing alveolitis associated with rheumatoid arthritis (disorder)","1","20220215"),
("ILD","SNOMED","319841000119107","rheumatoid lung disease with rheumatoid arthritis (disorder)","1","20220215"),
("ILD","SNOMED","398726004","rheumatoid lung disease (disorder)","1","20220215"),
("ILD","SNOMED","129451001","respiratory bronchiolitis associated interstitial lung disease (disorder)","1","20220215"),
("ILD","SNOMED","129458007","bronchiolitis obliterans organizing pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","14700006","bauxite fibrosis of lung (disorder)","1","20220215"),
("ILD","SNOMED","17385007","graphite fibrosis of lung (disorder)","1","20220215"),
("ILD","SNOMED","17996008","pneumoconiosis caused by inorganic dust (disorder)","1","20220215"),
("ILD","SNOMED","192658007","giant cell interstitial pneumonitis (disorder)","1","20220215"),
("ILD","SNOMED","196027008","toxic bronchiolitis obliterans (disorder)","1","20220215"),
("ILD","SNOMED","196053000","chronic drug-induced interstitial lung disorders (disorder)","1","20220215"),
("ILD","SNOMED","196125002","diffuse interstitial pulmonary fibrosis (disorder)","1","20220215"),
("ILD","SNOMED","22607003","asbestosis (disorder)","1","20220215"),
("ILD","SNOMED","233673002","drug-induced bronchiolitis obliterans (disorder)","1","20220215"),
("ILD","SNOMED","233703007","interstitial lung disease (disorder)","1","20220215"),
("ILD","SNOMED","233713004","seasonal cryptogenic organizing pneumonia with biochemical cholestasis (disorder)","1","20220215"),
("ILD","SNOMED","233723008","bronchiolitis obliterans with usual interstitial pneumonitis (disorder)","1","20220215"),
("ILD","SNOMED","233724002","toxic diffuse interstitial pulmonary fibrosis (disorder)","1","20220215"),
("ILD","SNOMED","233725001","drug-induced diffuse interstitial pulmonary fibrosis (disorder)","1","20220215"),
("ILD","SNOMED","233760007","acute silicosis (disorder)","1","20220215"),
("ILD","SNOMED","277844007","pulmonary lymphangioleiomyomatosis (disorder)","1","20220215"),
("ILD","SNOMED","36599006","chronic fibrosis of lung (disorder)","1","20220215"),
("ILD","SNOMED","40100001","obliterative bronchiolitis (disorder)","1","20220215"),
("ILD","SNOMED","40527005","idiopathic pulmonary hemosiderosis (disorder)","1","20220215"),
("ILD","SNOMED","40640008","massive fibrosis of lung co-occurrent and due to silicosis (disorder)","1","20220215"),
("ILD","SNOMED","427123006","interstitial lung disease due to collagen vascular disease (disorder)","1","20220215"),
("ILD","SNOMED","44274007","lymphoid interstitial pneumonia (disorder)","1","20220215"),
("ILD","SNOMED","47938003","chronic obliterative bronchiolitis (disorder)","1","20220215"),
("ILD","SNOMED","51615001","fibrosis of lung (disorder)","1","20220215"),
("ILD","SNOMED","62371005","pulmonary siderosis (disorder)","1","20220215"),
("ILD","SNOMED","711379004","interstitial lung disease due to connective tissue disease (disorder)","1","20220215"),
("ILD","SNOMED","71193007","fibrosis of lung caused by radiation (disorder)","1","20220215"),
("ILD","SNOMED","72270005","collagenous pneumoconiosis (disorder)","1","20220215"),
("ILD","SNOMED","196136009","lung disease co-occurrent with polymyositis (disorder)","1","20220215"),
("ILD","SNOMED","836478002","subacute obliterative bronchiolitis caused by chemical fumes (disorder)","1","20220215"),
("ILD","SNOMED","836479005","subacute obliterative bronchiolitis caused by vapor (disorder)","1","20220215"),
("ILD","SNOMED","840350008","chronic obliterative bronchiolitis caused by chemical fumes (disorder)","1","20220215"),
("ILD","SNOMED","840351007","chronic obliterative bronchiolitis caused by vapor (disorder)","1","20220215"),
("ILD","SNOMED","866103007","interstitial lung disease due to juvenile polymyositis (disorder)","1","20220215"),
("ILD","SNOMED","239297008","lymphomatoid granulomatosis of lung (disorder)","1","20220215"),
("ILD","SNOMED","870573008","interstitial pneumonia with autoimmune features (disorder)","1","20220215"),
("ILD","SNOMED","1017196003","interstitial pulmonary fibrosis due to inhalation of substance (disorder)","1","20220215"),
("ILD","SNOMED","1017197007","interstitial pulmonary fibrosis due to inhalation of drug (disorder)","1","20220215"),
("ILD","SNOMED","700252003","subacute idiopathic pulmonary fibrosis (disorder)","1","20220215"),
("ILD","SNOMED","708537005","acute idiopathic pulmonary fibrosis (disorder)","1","20220215"),
("ILD","SNOMED","426437004","familial idiopathic pulmonary fibrosis (disorder)","1","20220215"),
("ILD","SNOMED","700250006","idiopathic pulmonary fibrosis (disorder)","1","20220215"),
("ILD","SNOMED","700251005","chronic idiopathic pulmonary fibrosis (disorder)","1","20220215"),
("ILD","SNOMED","789574002","acute exacerbation of idiopathic pulmonary fibrosis (disorder)","1","20220215"),
("ILD","ICD10","J70.2","acute drug-induced interstitial lung disorders","1","20230803"), # added in 20230822
("ILD","ICD10","J70.0","acute pulmonary manifestations due to radiation","1","20230803"),
("ILD","ICD10","J67.7","air-conditioner and humidifier lung","1","20230803"),
("ILD","ICD10","J66.8","airway disease due to other specific organic dusts","1","20230803"),
("ILD","ICD10","J66","airway disease due to specific organic dust","1","20230803"),
("ILD","ICD10","J63.0","aluminosis (of lung)","1","20230803"),
("ILD","ICD10","J84.0","alveolar and parietoalveolar conditions","1","20230803"),
("ILD","ICD10","B44","aspergillosis","1","20230803"),
("ILD","ICD10","B44.9","aspergillosis, unspecified","1","20230803"),
("ILD","ICD10","J67.1","bagassosis","1","20230803"),
("ILD","ICD10","J63.1","bauxite fibrosis (of lung)","1","20230803"),
("ILD","ICD10","J63.2","berylliosis","1","20230803"),
("ILD","ICD10","J67.2","bird fancier lung","1","20230803"),
("ILD","ICD10","J68.0","bronchitis and pneumonitis due to chemicals, gases, fumes and vapours","1","20230803"),
("ILD","ICD10","J66.0","byssinosis (airway disease due to cotton dust)","1","20230803"),
("ILD","ICD10","J66.2","cannabinosis","1","20230803"),
("ILD","ICD10","J70.1","chronic and other pulmonary manifestations due to radiation","1","20230803"),
("ILD","ICD10","J70.3","chronic drug-induced interstitial lung disorders","1","20230803"),
("ILD","ICD10","J68.4","chronic respiratory conditions due to chemicals, gases, fumes and vapours","1","20230803"),
("ILD","ICD10","J60","coalworker pneumoconiosis","1","20230803"),
("ILD","ICD10","B44.7","disseminated aspergillosis","1","20230803"),
("ILD","ICD10","J70.4","drug-induced interstitial lung disorders, unspecified","1","20230803"),
("ILD","ICD10","M32.0","drug-induced systemic lupus erythematosus","1","20230803"),
("ILD","ICD10","J67.0","farmer lung","1","20230803"),
("ILD","ICD10","J66.1","flax-dresser disease","1","20230803"),
("ILD","ICD10","J63.3","graphite fibrosis (of lung)","1","20230803"),
("ILD","ICD10","B22.1","hiv disease resulting in lymphoid interstitial pneumonitis","1","20230803"),
("ILD","ICD10","J67","hypersensitivity pneumonitis due to organic dust","1","20230803"),
("ILD","ICD10","J67.8","hypersensitivity pneumonitis due to other organic dusts","1","20230803"),
("ILD","ICD10","J67.9","hypersensitivity pneumonitis due to unspecified organic dust","1","20230803"),
("ILD","ICD10","M60.0","infective myositis","1","20230803"),
("ILD","ICD10","J98.2","interstitial emphysema","1","20230803"),
("ILD","ICD10","M60.1","interstitial myositis","1","20230803"),
("ILD","ICD10","J84.9","interstitial pulmonary disease unspecified","1","20230803"),
("ILD","ICD10","B44.0","invasive pulmonary aspergillosis","1","20230803"),


#ICD-10 CVD codes
("cvd","ICD10","I00","Rheumatic fever without mention of heart involvement","1", "20231102"),
("cvd","ICD10","I01","Rheumatic fever with heart involvement","1", "20231102"),
("cvd","ICD10","I01.0","Acute rheumatic pericarditis","1", "20231102"),
("cvd","ICD10","I01.1","Acute rheumatic endocarditis","1", "20231102"),
("cvd","ICD10","I01.2","Acute rheumatic myocarditis","1", "20231102"),
("cvd","ICD10","I01.8","Other acute rheumatic heart disease","1", "20231102"),
("cvd","ICD10","I01.9","Acute rheumatic heart disease, unspecified","1", "20231102"),
("cvd","ICD10","I02","Rheumatic chorea","1", "20231102"),
("cvd","ICD10","I02.0","Rheumatic chorea with heart involvement","1", "20231102"),
("cvd","ICD10","I02.9","Rheumatic chorea without heart involvement","1", "20231102"),
("cvd","ICD10","I05","Rheumatic mitral valve diseases","1", "20231102"),
("cvd","ICD10","I05.0","Mitral stenosis","1", "20231102"),
("cvd","ICD10","I05.1","Rheumatic mitral insufficiency","1", "20231102"),
("cvd","ICD10","I05.2","Mitral stenosis with insufficiency","1", "20231102"),
("cvd","ICD10","I05.8","Other mitral valve diseases","1", "20231102"),
("cvd","ICD10","I05.9","Mitral valve disease, unspecified","1", "20231102"),
("cvd","ICD10","I06","Rheumatic aortic valve diseases","1", "20231102"),
("cvd","ICD10","I06.0","Rheumatic aortic stenosis","1", "20231102"),
("cvd","ICD10","I06.1","Rheumatic aortic insufficiency","1", "20231102"),
("cvd","ICD10","I06.2","Rheumatic aortic stenosis with insufficiency","1", "20231102"),
("cvd","ICD10","I06.8","Other rheumatic aortic valve diseases","1", "20231102"),
("cvd","ICD10","I06.9","Rheumatic aortic valve disease, unspecified","1", "20231102"),
("cvd","ICD10","I07","Rheumatic tricuspid valve diseases","1", "20231102"),
("cvd","ICD10","I07.0","Tricuspid stenosis","1", "20231102"),
("cvd","ICD10","I07.1","Tricuspid insufficiency","1", "20231102"),
("cvd","ICD10","I07.2","Tricuspid stenosis with insufficiency","1", "20231102"),
("cvd","ICD10","I07.8","Other tricuspid valve diseases","1", "20231102"),
("cvd","ICD10","I07.9","Tricuspid valve disease, unspecified","1", "20231102"),
("cvd","ICD10","I08","Multiple valve diseases","1", "20231102"),
("cvd","ICD10","I08.0","Disorders of both mitral and aortic valves","1", "20231102"),
("cvd","ICD10","I08.1","Disorders of both mitral and tricuspid valves","1", "20231102"),
("cvd","ICD10","I08.2","Disorders of both aortic and tricuspid valves","1", "20231102"),
("cvd","ICD10","I08.3","Combined disorders of mitral, aortic and tricuspid valves","1", "20231102"),
("cvd","ICD10","I08.8","Other multiple valve diseases","1", "20231102"),
("cvd","ICD10","I08.9","Multiple valve disease, unspecified","1", "20231102"),
("cvd","ICD10","I09","Other rheumatic heart diseases","1", "20231102"),
("cvd","ICD10","I09.0","Rheumatic myocarditis","1", "20231102"),
("cvd","ICD10","I09.1","Rheumatic diseases of endocardium, valve unspecified","1", "20231102"),
("cvd","ICD10","I09.2","Chronic rheumatic pericarditis","1", "20231102"),
("cvd","ICD10","I09.8","Other specified rheumatic heart diseases","1", "20231102"),
("cvd","ICD10","I09.9","Rheumatic heart disease, unspecified","1", "20231102"),
("cvd","ICD10","I10","Essential (primary) hypertension","1", "20231102"),
("cvd","ICD10","I11","Hypertensive heart disease","1", "20231102"),
("cvd","ICD10","I11.0","Hypertensive heart disease with (congestive) heart failure","1", "20231102"),
("cvd","ICD10","I11.9","Hypertensive heart disease without (congestive) heart failure","1", "20231102"),
("cvd","ICD10","I12","Hypertensive renal disease","1", "20231102"),
("cvd","ICD10","I12.0","Hypertensive renal disease with renal failure","1", "20231102"),
("cvd","ICD10","I12.9","Hypertensive renal disease without renal failure","1", "20231102"),
("cvd","ICD10","I13","Hypertensive heart and renal disease","1", "20231102"),
("cvd","ICD10","I13.0","Hypertensive heart and renal disease with (congestive) heart failure","1", "20231102"),
("cvd","ICD10","I13.1","Hypertensive heart and renal disease with renal failure","1", "20231102"),
("cvd","ICD10","I13.2","Hypertensive heart and renal disease with both (congestive) heart failure and renal failure","1", "20231102"),
("cvd","ICD10","I13.9","Hypertensive heart and renal disease, unspecified","1", "20231102"),
("cvd","ICD10","I15","Secondary hypertension","1", "20231102"),
("cvd","ICD10","I15.0","Renovascular hypertension","1", "20231102"),
("cvd","ICD10","I15.1","Hypertension secondary to other renal disorders","1", "20231102"),
("cvd","ICD10","I15.2","Hypertension secondary to endocrine disorders","1", "20231102"),
("cvd","ICD10","I15.8","Other secondary hypertension","1", "20231102"),
("cvd","ICD10","I15.9","Secondary hypertension, unspecified","1", "20231102"),
("cvd","ICD10","I20","Angina pectoris","1", "20231102"),
("cvd","ICD10","I20.0","Unstable angina","1", "20231102"),
("cvd","ICD10","I20.1","Angina pectoris with documented spasm","1", "20231102"),
("cvd","ICD10","I20.8","Other forms of angina pectoris","1", "20231102"),
("cvd","ICD10","I20.9","Angina pectoris, unspecified","1", "20231102"),
("cvd","ICD10","I21","Acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I21.0","Acute transmural myocardial infarction of anterior wall","1", "20231102"),
("cvd","ICD10","I21.1","Acute transmural myocardial infarction of inferior wall","1", "20231102"),
("cvd","ICD10","I21.2","Acute transmural myocardial infarction of other sites","1", "20231102"),
("cvd","ICD10","I21.3","Acute transmural myocardial infarction of unspecified site","1", "20231102"),
("cvd","ICD10","I21.4","Acute subendocardial myocardial infarction","1", "20231102"),
("cvd","ICD10","I21.9","Acute myocardial infarction, unspecified","1", "20231102"),
("cvd","ICD10","I22","Subsequent myocardial infarction","1", "20231102"),
("cvd","ICD10","I22.0","Subsequent myocardial infarction of anterior wall","1", "20231102"),
("cvd","ICD10","I22.1","Subsequent myocardial infarction of inferior wall","1", "20231102"),
("cvd","ICD10","I22.8","Subsequent myocardial infarction of other sites","1", "20231102"),
("cvd","ICD10","I22.9","Subsequent myocardial infarction of unspecified site","1", "20231102"),
("cvd","ICD10","I23","Certain current complications following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I23.0","Haemopericardium as current complication following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I23.1","Atrial septal defect as current complication following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I23.2","Ventricular septal defect as current complication following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I23.3","Rupture of cardiac wall without haemopericardium as current complication following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I23.4","Rupture of chordae tendineae as current complication following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I23.5","Rupture of papillary muscle as current complication following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I23.6","Thrombosis of atrium, auricular appendage, and ventricle as current complications following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I23.8","Other current complications following acute myocardial infarction","1", "20231102"),
("cvd","ICD10","I24","Other acute ischaemic heart diseases","1", "20231102"),
("cvd","ICD10","I24.0","Coronary thrombosis not resulting in myocardial infarction","1", "20231102"),
("cvd","ICD10","I24.1","Dressler syndrome","1", "20231102"),
("cvd","ICD10","I24.8","Other forms of acute ischaemic heart disease","1", "20231102"),
("cvd","ICD10","I24.9","Acute ischaemic heart disease, unspecified","1", "20231102"),
("cvd","ICD10","I25","Chronic ischaemic heart disease","1", "20231102"),
("cvd","ICD10","I25.0","Atherosclerotic cardiovascular disease, so described","1", "20231102"),
("cvd","ICD10","I25.1","Atherosclerotic heart disease","1", "20231102"),
("cvd","ICD10","I25.2","Old myocardial infarction","1", "20231102"),
("cvd","ICD10","I25.3","Aneurysm of heart","1", "20231102"),
("cvd","ICD10","I25.4","Coronary artery aneurysm and dissection","1", "20231102"),
("cvd","ICD10","I25.5","Ischaemic cardiomyopathy","1", "20231102"),
("cvd","ICD10","I25.6","Silent myocardial ischaemia","1", "20231102"),
("cvd","ICD10","I25.8","Other forms of chronic ischaemic heart disease","1", "20231102"),
("cvd","ICD10","I25.9","Chronic ischaemic heart disease, unspecified","1", "20231102"),
("cvd","ICD10","I26","Pulmonary embolism","1", "20231102"),
("cvd","ICD10","I26.0","Pulmonary embolism with mention of acute cor pulmonale","1", "20231102"),
("cvd","ICD10","I26.9","Pulmonary embolism without mention of acute cor pulmonale","1", "20231102"),
("cvd","ICD10","I27","Other pulmonary heart diseases","1", "20231102"),
("cvd","ICD10","I27.0","Primary pulmonary hypertension","1", "20231102"),
("cvd","ICD10","I27.1","Kyphoscoliotic heart disease","1", "20231102"),
("cvd","ICD10","I27.2","Other secondary pulmonary hypertension","1", "20231102"),
("cvd","ICD10","I27.8","Other specified pulmonary heart diseases","1", "20231102"),
("cvd","ICD10","I27.9","Pulmonary heart disease, unspecified","1", "20231102"),
("cvd","ICD10","I28","Other diseases of pulmonary vessels","1", "20231102"),
("cvd","ICD10","I28.0","Arteriovenous fistula of pulmonary vessels","1", "20231102"),
("cvd","ICD10","I28.1","Aneurysm of pulmonary artery","1", "20231102"),
("cvd","ICD10","I28.8","Other specified diseases of pulmonary vessels","1", "20231102"),
("cvd","ICD10","I28.9","Disease of pulmonary vessels, unspecified","1", "20231102"),
("cvd","ICD10","I30","Acute pericarditis","1", "20231102"),
("cvd","ICD10","I30.0","Acute nonspecific idiopathic pericarditis","1", "20231102"),
("cvd","ICD10","I30.1","Infective pericarditis","1", "20231102"),
("cvd","ICD10","I30.8","Other forms of acute pericarditis","1", "20231102"),
("cvd","ICD10","I30.9","Acute pericarditis, unspecified","1", "20231102"),
("cvd","ICD10","I31","Other diseases of pericardium","1", "20231102"),
("cvd","ICD10","I31.0","Chronic adhesive pericarditis","1", "20231102"),
("cvd","ICD10","I31.1","Chronic constrictive pericarditis","1", "20231102"),
("cvd","ICD10","I31.2","Haemopericardium, not elsewhere classified","1", "20231102"),
("cvd","ICD10","I31.3","Pericardial effusion (noninflammatory)","1", "20231102"),
("cvd","ICD10","I31.8","Other specified diseases of pericardium","1", "20231102"),
("cvd","ICD10","I31.9","Disease of pericardium, unspecified","1", "20231102"),
("cvd","ICD10","I32","Pericarditis in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I32.0","Pericarditis in bacterial diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I32.1","Pericarditis in other infectious and parasitic diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I32.8","Pericarditis in other diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I33","Acute and subacute endocarditis","1", "20231102"),
("cvd","ICD10","I33.0","Acute and subacute infective endocarditis","1", "20231102"),
("cvd","ICD10","I33.9","Acute endocarditis, unspecified","1", "20231102"),
("cvd","ICD10","I34","Nonrheumatic mitral valve disorders","1", "20231102"),
("cvd","ICD10","I34.0","Mitral (valve) insufficiency","1", "20231102"),
("cvd","ICD10","I34.1","Mitral (valve) prolapse","1", "20231102"),
("cvd","ICD10","I34.2","Nonrheumatic mitral (valve) stenosis","1", "20231102"),
("cvd","ICD10","I34.8","Other nonrheumatic mitral valve disorders","1", "20231102"),
("cvd","ICD10","I34.9","Nonrheumatic mitral valve disorder, unspecified","1", "20231102"),
("cvd","ICD10","I35","Nonrheumatic aortic valve disorders","1", "20231102"),
("cvd","ICD10","I35.0","Aortic (valve) stenosis","1", "20231102"),
("cvd","ICD10","I35.1","Aortic (valve) insufficiency","1", "20231102"),
("cvd","ICD10","I35.2","Aortic (valve) stenosis with insufficiency","1", "20231102"),
("cvd","ICD10","I35.8","Other aortic valve disorders","1", "20231102"),
("cvd","ICD10","I35.9","Aortic valve disorder, unspecified","1", "20231102"),
("cvd","ICD10","I36","Nonrheumatic tricuspid valve disorders","1", "20231102"),
("cvd","ICD10","I36.0","Nonrheumatic tricuspid (valve) stenosis","1", "20231102"),
("cvd","ICD10","I36.1","Nonrheumatic tricuspid (valve) insufficiency","1", "20231102"),
("cvd","ICD10","I36.2","Nonrheumatic tricuspid (valve) stenosis with insufficiency","1", "20231102"),
("cvd","ICD10","I36.8","Other nonrheumatic tricuspid valve disorders","1", "20231102"),
("cvd","ICD10","I36.9","Nonrheumatic tricuspid valve disorder, unspecified","1", "20231102"),
("cvd","ICD10","I37","Pulmonary valve disorders","1", "20231102"),
("cvd","ICD10","I37.0","Pulmonary valve stenosis","1", "20231102"),
("cvd","ICD10","I37.1","Pulmonary valve insufficiency","1", "20231102"),
("cvd","ICD10","I37.2","Pulmonary valve stenosis with insufficiency","1", "20231102"),
("cvd","ICD10","I37.8","Other pulmonary valve disorders","1", "20231102"),
("cvd","ICD10","I37.9","Pulmonary valve disorder, unspecified","1", "20231102"),
("cvd","ICD10","I38","Endocarditis, valve unspecified","1", "20231102"),
("cvd","ICD10","I39","Endocarditis and heart valve disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I39.0","Mitral valve disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I39.1","Aortic valve disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I39.2","Tricuspid valve disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I39.3","Pulmonary valve disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I39.4","Multiple valve disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I39.8","Endocarditis, valve unspecified, in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I40","Acute myocarditis","1", "20231102"),
("cvd","ICD10","I40.0","Infective myocarditis","1", "20231102"),
("cvd","ICD10","I40.1","Isolated myocarditis","1", "20231102"),
("cvd","ICD10","I40.8","Other acute myocarditis","1", "20231102"),
("cvd","ICD10","I40.9","Acute myocarditis, unspecified","1", "20231102"),
("cvd","ICD10","I41","Myocarditis in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I41.0","Myocarditis in bacterial diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I41.1","Myocarditis in viral diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I41.2","Myocarditis in other infectious and parasitic diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I41.8","Myocarditis in other diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I42","Cardiomyopathy","1", "20231102"),
("cvd","ICD10","I42.0","Dilated cardiomyopathy","1", "20231102"),
("cvd","ICD10","I42.1","Obstructive hypertrophic cardiomyopathy","1", "20231102"),
("cvd","ICD10","I42.2","Other hypertrophic cardiomyopathy","1", "20231102"),
("cvd","ICD10","I42.3","Endomyocardial (eosinophilic) disease","1", "20231102"),
("cvd","ICD10","I42.4","Endocardial fibroelastosis","1", "20231102"),
("cvd","ICD10","I42.5","Other restrictive cardiomyopathy","1", "20231102"),
("cvd","ICD10","I42.6","Alcoholic cardiomyopathy","1", "20231102"),
("cvd","ICD10","I42.7","Cardiomyopathy due to drugs and other external agents","1", "20231102"),
("cvd","ICD10","I42.8","Other cardiomyopathies","1", "20231102"),
("cvd","ICD10","I42.9","Cardiomyopathy, unspecified","1", "20231102"),
("cvd","ICD10","I43","Cardiomyopathy in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I43.0","Cardiomyopathy in infectious and parasitic diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I43.1","Cardiomyopathy in metabolic diseases","1", "20231102"),
("cvd","ICD10","I43.2","Cardiomyopathy in nutritional diseases","1", "20231102"),
("cvd","ICD10","I43.8","Cardiomyopathy in other diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I44","Atrioventricular and left bundle-branch block","1", "20231102"),
("cvd","ICD10","I44.0","Atrioventricular block, first degree","1", "20231102"),
("cvd","ICD10","I44.1","Atrioventricular block, second degree","1", "20231102"),
("cvd","ICD10","I44.2","Atrioventricular block, complete","1", "20231102"),
("cvd","ICD10","I44.3","Other and unspecified atrioventricular block","1", "20231102"),
("cvd","ICD10","I44.4","Left anterior fascicular block","1", "20231102"),
("cvd","ICD10","I44.5","Left posterior fascicular block","1", "20231102"),
("cvd","ICD10","I44.6","Other and unspecified fascicular block","1", "20231102"),
("cvd","ICD10","I44.7","Left bundle-branch block, unspecified","1", "20231102"),
("cvd","ICD10","I45","Other conduction disorders","1", "20231102"),
("cvd","ICD10","I45.0","Right fascicular block","1", "20231102"),
("cvd","ICD10","I45.1","Other and unspecified right bundle-branch block","1", "20231102"),
("cvd","ICD10","I45.2","Bifascicular block","1", "20231102"),
("cvd","ICD10","I45.3","Trifascicular block","1", "20231102"),
("cvd","ICD10","I45.4","Nonspecific intraventricular block","1", "20231102"),
("cvd","ICD10","I45.5","Other specified heart block","1", "20231102"),
("cvd","ICD10","I45.6","Pre-excitation syndrome","1", "20231102"),
("cvd","ICD10","I45.8","Other specified conduction disorders","1", "20231102"),
("cvd","ICD10","I45.9","Conduction disorder, unspecified","1", "20231102"),
("cvd","ICD10","I46","Cardiac arrest","1", "20231102"),
("cvd","ICD10","I46.0","Cardiac arrest with successful resuscitation","1", "20231102"),
("cvd","ICD10","I46.1","Sudden cardiac death, so described","1", "20231102"),
("cvd","ICD10","I46.9","Cardiac arrest, unspecified","1", "20231102"),
("cvd","ICD10","I47","Paroxysmal tachycardia","1", "20231102"),
("cvd","ICD10","I47.0","Re-entry ventricular arrhythmia","1", "20231102"),
("cvd","ICD10","I47.1","Supraventricular tachycardia","1", "20231102"),
("cvd","ICD10","I47.2","Ventricular tachycardia","1", "20231102"),
("cvd","ICD10","I47.9","Paroxysmal tachycardia, unspecified","1", "20231102"),
("cvd","ICD10","I48","Atrial fibrillation and flutter","1", "20231102"),
("cvd","ICD10","I48.0","Paroxysmal atrial fibrillation","1", "20231102"),
("cvd","ICD10","I48.1","Persistent atrial fibrillation","1", "20231102"),
("cvd","ICD10","I48.2","Chronic atrial fibrillation","1", "20231102"),
("cvd","ICD10","I48.3","Typical atrial flutter","1", "20231102"),
("cvd","ICD10","I48.4","Atypical atrial flutter","1", "20231102"),
("cvd","ICD10","I48.9","Atrial fibrillation and atrial flutter, unspecified","1", "20231102"),
("cvd","ICD10","I49","Other cardiac arrhythmias","1", "20231102"),
("cvd","ICD10","I49.0","Ventricular fibrillation and flutter","1", "20231102"),
("cvd","ICD10","I49.1","Atrial premature depolarization","1", "20231102"),
("cvd","ICD10","I49.2","Junctional premature depolarization","1", "20231102"),
("cvd","ICD10","I49.3","Ventricular premature depolarization","1", "20231102"),
("cvd","ICD10","I49.4","Other and unspecified premature depolarization","1", "20231102"),
("cvd","ICD10","I49.5","Sick sinus syndrome","1", "20231102"),
("cvd","ICD10","I49.8","Other specified cardiac arrhythmias","1", "20231102"),
("cvd","ICD10","I49.9","Cardiac arrhythmia, unspecified","1", "20231102"),
("cvd","ICD10","I50","Heart failure","1", "20231102"),
("cvd","ICD10","I50.0","Congestive heart failure","1", "20231102"),
("cvd","ICD10","I50.1","Left ventricular failure","1", "20231102"),
("cvd","ICD10","I50.9","Heart failure, unspecified","1", "20231102"),
("cvd","ICD10","I51","Complications and ill-defined descriptions of heart disease","1", "20231102"),
("cvd","ICD10","I51.0","Cardiac septal defect, acquired","1", "20231102"),
("cvd","ICD10","I51.1","Rupture of chordae tendineae, not elsewhere classified","1", "20231102"),
("cvd","ICD10","I51.2","Rupture of papillary muscle, not elsewhere classified","1", "20231102"),
("cvd","ICD10","I51.3","Intracardiac thrombosis, not elsewhere classified","1", "20231102"),
("cvd","ICD10","I51.4","Myocarditis, unspecified","1", "20231102"),
("cvd","ICD10","I51.5","Myocardial degeneration","1", "20231102"),
("cvd","ICD10","I51.6","Cardiovascular disease, unspecified","1", "20231102"),
("cvd","ICD10","I51.7","Cardiomegaly","1", "20231102"),
("cvd","ICD10","I51.8","Other ill-defined heart diseases","1", "20231102"),
("cvd","ICD10","I51.9","Heart disease, unspecified","1", "20231102"),
("cvd","ICD10","I52","Other heart disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I52.0","Other heart disorders in bacterial diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I52.1","Other heart disorders in other infectious and parasitic diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I52.8","Other heart disorders in other diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I60","Subarachnoid haemorrhage","1", "20231102"),
("cvd","ICD10","I60.0","Subarachnoid haemorrhage from carotid siphon and bifurcation","1", "20231102"),
("cvd","ICD10","I60.1","Subarachnoid haemorrhage from middle cerebral artery","1", "20231102"),
("cvd","ICD10","I60.2","Subarachnoid haemorrhage from anterior communicating artery","1", "20231102"),
("cvd","ICD10","I60.3","Subarachnoid haemorrhage from posterior communicating artery","1", "20231102"),
("cvd","ICD10","I60.4","Subarachnoid haemorrhage from basilar artery","1", "20231102"),
("cvd","ICD10","I60.5","Subarachnoid haemorrhage from vertebral artery","1", "20231102"),
("cvd","ICD10","I60.6","Subarachnoid haemorrhage from other intracranial arteries","1", "20231102"),
("cvd","ICD10","I60.7","Subarachnoid haemorrhage from intracranial artery, unspecified","1", "20231102"),
("cvd","ICD10","I60.8","Other subarachnoid haemorrhage","1", "20231102"),
("cvd","ICD10","I60.9","Subarachnoid haemorrhage, unspecified","1", "20231102"),
("cvd","ICD10","I61","Intracerebral haemorrhage","1", "20231102"),
("cvd","ICD10","I61.0","Intracerebral haemorrhage in hemisphere, subcortical","1", "20231102"),
("cvd","ICD10","I61.1","Intracerebral haemorrhage in hemisphere, cortical","1", "20231102"),
("cvd","ICD10","I61.2","Intracerebral haemorrhage in hemisphere, unspecified","1", "20231102"),
("cvd","ICD10","I61.3","Intracerebral haemorrhage in brain stem","1", "20231102"),
("cvd","ICD10","I61.4","Intracerebral haemorrhage in cerebellum","1", "20231102"),
("cvd","ICD10","I61.5","Intracerebral haemorrhage, intraventricular","1", "20231102"),
("cvd","ICD10","I61.6","Intracerebral haemorrhage, multiple localized","1", "20231102"),
("cvd","ICD10","I61.8","Other intracerebral haemorrhage","1", "20231102"),
("cvd","ICD10","I61.9","Intracerebral haemorrhage, unspecified","1", "20231102"),
("cvd","ICD10","I62","Other nontraumatic intracranial haemorrhage","1", "20231102"),
("cvd","ICD10","I62.0","Subdural haemorrhage (acute)(nontraumatic)","1", "20231102"),
("cvd","ICD10","I62.1","Nontraumatic extradural haemorrhage","1", "20231102"),
("cvd","ICD10","I62.9","Intracranial haemorrhage (nontraumatic), unspecified","1", "20231102"),
("cvd","ICD10","I63","Cerebral infarction","1", "20231102"),
("cvd","ICD10","I63.0","Cerebral infarction due to thrombosis of precerebral arteries","1", "20231102"),
("cvd","ICD10","I63.1","Cerebral infarction due to embolism of precerebral arteries","1", "20231102"),
("cvd","ICD10","I63.2","Cerebral infarction due to unspecified occlusion or stenosis of precerebral arteries","1", "20231102"),
("cvd","ICD10","I63.3","Cerebral infarction due to thrombosis of cerebral arteries","1", "20231102"),
("cvd","ICD10","I63.4","Cerebral infarction due to embolism of cerebral arteries","1", "20231102"),
("cvd","ICD10","I63.5","Cerebral infarction due to unspecified occlusion or stenosis of cerebral arteries","1", "20231102"),
("cvd","ICD10","I63.6","Cerebral infarction due to cerebral venous thrombosis, nonpyogenic","1", "20231102"),
("cvd","ICD10","I63.8","Other cerebral infarction","1", "20231102"),
("cvd","ICD10","I63.9","Cerebral infarction, unspecified","1", "20231102"),
("cvd","ICD10","I64","Stroke, not specified as haemorrhage or infarction","1", "20231102"),
("cvd","ICD10","I65","Occlusion and stenosis of precerebral arteries, not resulting in cerebral infarction","1", "20231102"),
("cvd","ICD10","I65.0","Occlusion and stenosis of vertebral artery","1", "20231102"),
("cvd","ICD10","I65.1","Occlusion and stenosis of basilar artery","1", "20231102"),
("cvd","ICD10","I65.2","Occlusion and stenosis of carotid artery","1", "20231102"),
("cvd","ICD10","I65.3","Occlusion and stenosis of multiple and bilateral precerebral arteries","1", "20231102"),
("cvd","ICD10","I65.8","Occlusion and stenosis of other precerebral artery","1", "20231102"),
("cvd","ICD10","I65.9","Occlusion and stenosis of unspecified precerebral artery","1", "20231102"),
("cvd","ICD10","I66","Occlusion and stenosis of cerebral arteries, not resulting in cerebral infarction","1", "20231102"),
("cvd","ICD10","I66.0","Occlusion and stenosis of middle cerebral artery","1", "20231102"),
("cvd","ICD10","I66.1","Occlusion and stenosis of anterior cerebral artery","1", "20231102"),
("cvd","ICD10","I66.2","Occlusion and stenosis of posterior cerebral artery","1", "20231102"),
("cvd","ICD10","I66.3","Occlusion and stenosis of cerebellar arteries","1", "20231102"),
("cvd","ICD10","I66.4","Occlusion and stenosis of multiple and bilateral cerebral arteries","1", "20231102"),
("cvd","ICD10","I66.8","Occlusion and stenosis of other cerebral artery","1", "20231102"),
("cvd","ICD10","I66.9","Occlusion and stenosis of unspecified cerebral artery","1", "20231102"),
("cvd","ICD10","I67","Other cerebrovascular diseases","1", "20231102"),
("cvd","ICD10","I67.0","Dissection of cerebral arteries, nonruptured","1", "20231102"),
("cvd","ICD10","I67.1","Cerebral aneurysm, nonruptured","1", "20231102"),
("cvd","ICD10","I67.2","Cerebral atherosclerosis","1", "20231102"),
("cvd","ICD10","I67.3","Progressive vascular leukoencephalopathy","1", "20231102"),
("cvd","ICD10","I67.4","Hypertensive encephalopathy","1", "20231102"),
("cvd","ICD10","I67.5","Moyamoya disease","1", "20231102"),
("cvd","ICD10","I67.6","Nonpyogenic thrombosis of intracranial venous system","1", "20231102"),
("cvd","ICD10","I67.7","Cerebral arteritis, not elsewhere classified","1", "20231102"),
("cvd","ICD10","I67.8","Other specified cerebrovascular diseases","1", "20231102"),
("cvd","ICD10","I67.9","Cerebrovascular disease, unspecified","1", "20231102"),
("cvd","ICD10","I68","Cerebrovascular disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I68.0","Cerebral amyloid angiopathy","1", "20231102"),
("cvd","ICD10","I68.1","Cerebral arteritis in infectious and parasitic diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I68.2","Cerebral arteritis in other diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I68.8","Other cerebrovascular disorders in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I69","Sequelae of cerebrovascular disease","1", "20231102"),
("cvd","ICD10","I69.0","Sequelae of subarachnoid haemorrhage","1", "20231102"),
("cvd","ICD10","I69.1","Sequelae of intracerebral haemorrhage","1", "20231102"),
("cvd","ICD10","I69.2","Sequelae of other nontraumatic intracranial haemorrhage","1", "20231102"),
("cvd","ICD10","I69.3","Sequelae of cerebral infarction","1", "20231102"),
("cvd","ICD10","I69.4","Sequelae of stroke, not specified as haemorrhage or infarction","1", "20231102"),
("cvd","ICD10","I69.8","Sequelae of other and unspecified cerebrovascular diseases","1", "20231102"),
("cvd","ICD10","I70","Atherosclerosis","1", "20231102"),
("cvd","ICD10","I70.0","Atherosclerosis of aorta","1", "20231102"),
("cvd","ICD10","I70.1","Atherosclerosis of renal artery","1", "20231102"),
("cvd","ICD10","I70.2","Atherosclerosis of arteries of extremities","1", "20231102"),
("cvd","ICD10","I70.8","Atherosclerosis of other arteries","1", "20231102"),
("cvd","ICD10","I70.9","Generalized and unspecified atherosclerosis","1", "20231102"),
("cvd","ICD10","I71","Aortic aneurysm and dissection","1", "20231102"),
("cvd","ICD10","I71.0","Dissection of aorta [any part]","1", "20231102"),
("cvd","ICD10","I71.1","Thoracic aortic aneurysm, ruptured","1", "20231102"),
("cvd","ICD10","I71.2","Thoracic aortic aneurysm, without mention of rupture","1", "20231102"),
("cvd","ICD10","I71.3","Abdominal aortic aneurysm, ruptured","1", "20231102"),
("cvd","ICD10","I71.4","Abdominal aortic aneurysm, without mention of rupture","1", "20231102"),
("cvd","ICD10","I71.5","Thoracoabdominal aortic aneurysm, ruptured","1", "20231102"),
("cvd","ICD10","I71.6","Thoracoabdominal aortic aneurysm, without mention of rupture","1", "20231102"),
("cvd","ICD10","I71.8","Aortic aneurysm of unspecified site, ruptured","1", "20231102"),
("cvd","ICD10","I71.9","Aortic aneurysm of unspecified site, without mention of rupture","1", "20231102"),
("cvd","ICD10","I72","Other aneurysm and dissection","1", "20231102"),
("cvd","ICD10","I72.0","Aneurysm and dissection of carotid artery","1", "20231102"),
("cvd","ICD10","I72.1","Aneurysm and dissection of artery of upper extremity","1", "20231102"),
("cvd","ICD10","I72.2","Aneurysm and dissection of renal artery","1", "20231102"),
("cvd","ICD10","I72.3","Aneurysm and dissection of iliac artery","1", "20231102"),
("cvd","ICD10","I72.4","Aneurysm and dissection of artery of lower extremity","1", "20231102"),
("cvd","ICD10","I72.5","Aneurysm and dissection of other precerebral arteries","1", "20231102"),
("cvd","ICD10","I72.6","Aneurysm and dissection of vertebral artery","1", "20231102"),
("cvd","ICD10","I72.8","Aneurysm and dissection of other specified arteries","1", "20231102"),
("cvd","ICD10","I72.9","Aneurysm and dissection of unspecified site","1", "20231102"),
("cvd","ICD10","I73","Other peripheral vascular diseases","1", "20231102"),
("cvd","ICD10","I73.0","Raynaud syndrome","1", "20231102"),
("cvd","ICD10","I73.1","Thromboangiitis obliterans [Buerger]","1", "20231102"),
("cvd","ICD10","I73.8","Other specified peripheral vascular diseases","1", "20231102"),
("cvd","ICD10","I73.9","Peripheral vascular disease, unspecified","1", "20231102"),
("cvd","ICD10","I74","Arterial embolism and thrombosis","1", "20231102"),
("cvd","ICD10","I74.0","Embolism and thrombosis of abdominal aorta","1", "20231102"),
("cvd","ICD10","I74.1","Embolism and thrombosis of other and unspecified parts of aorta","1", "20231102"),
("cvd","ICD10","I74.2","Embolism and thrombosis of arteries of upper extremities","1", "20231102"),
("cvd","ICD10","I74.3","Embolism and thrombosis of arteries of lower extremities","1", "20231102"),
("cvd","ICD10","I74.4","Embolism and thrombosis of arteries of extremities, unspecified","1", "20231102"),
("cvd","ICD10","I74.5","Embolism and thrombosis of iliac artery","1", "20231102"),
("cvd","ICD10","I74.8","Embolism and thrombosis of other arteries","1", "20231102"),
("cvd","ICD10","I74.9","Embolism and thrombosis of unspecified artery","1", "20231102"),
("cvd","ICD10","I77","Other disorders of arteries and arterioles","1", "20231102"),
("cvd","ICD10","I77.0","Arteriovenous fistula, acquired","1", "20231102"),
("cvd","ICD10","I77.1","Stricture of artery","1", "20231102"),
("cvd","ICD10","I77.2","Rupture of artery","1", "20231102"),
("cvd","ICD10","I77.3","Arterial fibromuscular dysplasia","1", "20231102"),
("cvd","ICD10","I77.4","Coeliac artery compression syndrome","1", "20231102"),
("cvd","ICD10","I77.5","Necrosis of artery","1", "20231102"),
("cvd","ICD10","I77.6","Arteritis, unspecified","1", "20231102"),
("cvd","ICD10","I77.8","Other specified disorders of arteries and arterioles","1", "20231102"),
("cvd","ICD10","I77.9","Disorder of arteries and arterioles, unspecified","1", "20231102"),
("cvd","ICD10","I78","Diseases of capillaries","1", "20231102"),
("cvd","ICD10","I78.0","Hereditary haemorrhagic telangiectasia","1", "20231102"),
("cvd","ICD10","I78.1","Naevus, non-neoplastic","1", "20231102"),
("cvd","ICD10","I78.8","Other diseases of capillaries","1", "20231102"),
("cvd","ICD10","I78.9","Disease of capillaries, unspecified","1", "20231102"),
("cvd","ICD10","I79","Disorders of arteries, arterioles and capillaries in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I79.0","Aneurysm of aorta in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I79.1","Aortitis in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I79.2","Peripheral angiopathy in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I79.8","Other disorders of arteries, arterioles and capillaries in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I80","Phlebitis and thrombophlebitis","1", "20231102"),
("cvd","ICD10","I80.0","Phlebitis and thrombophlebitis of superficial vessels of lower extremities","1", "20231102"),
("cvd","ICD10","I80.1","Phlebitis and thrombophlebitis of femoral vein","1", "20231102"),
("cvd","ICD10","I80.2","Phlebitis and thrombophlebitis of other deep vessels of lower extremities","1", "20231102"),
("cvd","ICD10","I80.3","Phlebitis and thrombophlebitis of lower extremities, unspecified","1", "20231102"),
("cvd","ICD10","I80.8","Phlebitis and thrombophlebitis of other sites","1", "20231102"),
("cvd","ICD10","I80.9","Phlebitis and thrombophlebitis of unspecified site","1", "20231102"),
("cvd","ICD10","I81","Portal vein thrombosis","1", "20231102"),
("cvd","ICD10","I82","Other venous embolism and thrombosis","1", "20231102"),
("cvd","ICD10","I82.0","Budd-Chiari syndrome","1", "20231102"),
("cvd","ICD10","I82.1","Thrombophlebitis migrans","1", "20231102"),
("cvd","ICD10","I82.2","Embolism and thrombosis of vena cava","1", "20231102"),
("cvd","ICD10","I82.3","Embolism and thrombosis of renal vein","1", "20231102"),
("cvd","ICD10","I82.8","Embolism and thrombosis of other specified veins","1", "20231102"),
("cvd","ICD10","I82.9","Embolism and thrombosis of unspecified vein","1", "20231102"),
("cvd","ICD10","I83","Varicose veins of lower extremities","1", "20231102"),
("cvd","ICD10","I83.0","Varicose veins of lower extremities with ulcer","1", "20231102"),
("cvd","ICD10","I83.1","Varicose veins of lower extremities with inflammation","1", "20231102"),
("cvd","ICD10","I83.2","Varicose veins of lower extremities with both ulcer and inflammation","1", "20231102"),
("cvd","ICD10","I83.9","Varicose veins of lower extremities without ulcer or inflammation","1", "20231102"),
("cvd","ICD10","I85","Oesophageal varices","1", "20231102"),
("cvd","ICD10","I85.0","Oesophageal varices with bleeding","1", "20231102"),
("cvd","ICD10","I85.9","Oesophageal varices without bleeding","1", "20231102"),
("cvd","ICD10","I86","Varicose veins of other sites","1", "20231102"),
("cvd","ICD10","I86.0","Sublingual varices","1", "20231102"),
("cvd","ICD10","I86.1","Scrotal varices","1", "20231102"),
("cvd","ICD10","I86.2","Pelvic varices","1", "20231102"),
("cvd","ICD10","I86.3","Vulval varices","1", "20231102"),
("cvd","ICD10","I86.4","Gastric varices","1", "20231102"),
("cvd","ICD10","I86.8","Varicose veins of other specified sites","1", "20231102"),
("cvd","ICD10","I87","Other disorders of veins","1", "20231102"),
("cvd","ICD10","I87.0","Postthrombotic syndrome","1", "20231102"),
("cvd","ICD10","I87.1","Compression of vein","1", "20231102"),
("cvd","ICD10","I87.2","Venous insufficiency (chronic)(peripheral)","1", "20231102"),
("cvd","ICD10","I87.8","Other specified disorders of veins","1", "20231102"),
("cvd","ICD10","I87.9","Disorder of vein, unspecified","1", "20231102"),
("cvd","ICD10","I88","Nonspecific lymphadenitis","1", "20231102"),
("cvd","ICD10","I88.0","Nonspecific mesenteric lymphadenitis","1", "20231102"),
("cvd","ICD10","I88.1","Chronic lymphadenitis, except mesenteric","1", "20231102"),
("cvd","ICD10","I88.8","Other nonspecific lymphadenitis","1", "20231102"),
("cvd","ICD10","I88.9","Nonspecific lymphadenitis, unspecified","1", "20231102"),
("cvd","ICD10","I89","Other noninfective disorders of lymphatic vessels and lymph nodes","1", "20231102"),
("cvd","ICD10","I89.0","Lymphoedema, not elsewhere classified","1", "20231102"),
("cvd","ICD10","I89.1","Lymphangitis","1", "20231102"),
("cvd","ICD10","I89.8","Other specified noninfective disorders of lymphatic vessels and lymph nodes","1", "20231102"),
("cvd","ICD10","I89.9","Noninfective disorder of lymphatic vessels and lymph nodes, unspecified","1", "20231102"),
("cvd","ICD10","I95","Hypotension","1", "20231102"),
("cvd","ICD10","I95.0","Idiopathic hypotension","1", "20231102"),
("cvd","ICD10","I95.1","Orthostatic hypotension","1", "20231102"),
("cvd","ICD10","I95.2","Hypotension due to drugs","1", "20231102"),
("cvd","ICD10","I95.8","Other hypotension","1", "20231102"),
("cvd","ICD10","I95.9","Hypotension, unspecified","1", "20231102"),
("cvd","ICD10","I97","Postprocedural disorders of circulatory system, not elsewhere classified","1", "20231102"),
("cvd","ICD10","I97.0","Postcardiotomy syndrome","1", "20231102"),
("cvd","ICD10","I97.1","Other functional disturbances following cardiac surgery","1", "20231102"),
("cvd","ICD10","I97.2","Postmastectomy lymphoedema syndrome","1", "20231102"),
("cvd","ICD10","I97.8","Other postprocedural disorders of circulatory system, not elsewhere classified","1", "20231102"),
("cvd","ICD10","I97.9","Postprocedural disorder of circulatory system, unspecified","1", "20231102"),
("cvd","ICD10","I98","Other disorders of circulatory system in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I98.0","Cardiovascular syphilis","1", "20231102"),
("cvd","ICD10","I98.1","Cardiovascular disorders in other infectious and parasitic diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I98.2","Oesophageal varices without bleeding in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I98.3","Oesophageal varices with bleeding in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I98.8","Other specified disorders of circulatory system in diseases classified elsewhere","1", "20231102"),
("cvd","ICD10","I99","Other and unspecified disorders of circulatory system","1", "20231102")
], ['name', 'terminology', 'code', 'term', 'code_type', 'RecordDate']) 



# check
tmpt = tab(codelist_hw, 'name', 'terminology'); print()

codelist = (
  codelist_hw
  .withColumn('name', f.when(f.col('name') == 'copd', f.lit('COPD')).otherwise(f.col('name')))
)

tmpt = tab(codelist, 'name', 'terminology'); print()

# COMMAND ----------

# MAGIC %md # 3. Check

# COMMAND ----------

# check
tmpt = tab(codelist, 'name'); print()
tmpt = tab(codelist, 'terminology'); print()
tmpt = tab(codelist, 'name', 'terminology'); print()
count_varlist(codelist, ['name', 'terminology', 'code'])
print(codelist.orderBy('name', 'terminology', 'code').limit(10).toPandas().to_string()); print()

# COMMAND ----------

tmpt = tab(codelist, 'name', 'code_type'); print()
assert codelist.where(f.col('code_type') == 0).count() == 0

# COMMAND ----------

display(codelist)

# COMMAND ----------

# MAGIC %md # 4. Reformat

# COMMAND ----------

# remove trailing X's, decimal points, dashes, and spaces
codelist = (
  codelist
  .withColumn('_code_old', f.col('code'))
  .withColumn('code', f.when(f.col('terminology') == 'ICD10', f.regexp_replace('code', r'X$', '')).otherwise(f.col('code')))\
  .withColumn('code', f.when(f.col('terminology') == 'ICD10', f.regexp_replace('code', r'[\.\-\s]', '')).otherwise(f.col('code')))
  .withColumn('_code_diff', f.when(f.col('code') != f.col('_code_old'), 1).otherwise(0))
)

# check
tmpt = tab(codelist, '_code_diff'); print()
print(codelist.where(f.col('_code_diff') == 1).orderBy('name', 'terminology', 'code').toPandas().to_string()); print()

# tidy
codelist = codelist.drop('_code_old', '_code_diff')

# COMMAND ----------

# MAGIC %md # 5. Check

# COMMAND ----------

# check 
tmpt = tab(codelist, 'name', 'terminology')

# COMMAND ----------

# check
display(codelist)

# COMMAND ----------

# check
display(codelist.where(f.col('terminology') == 'ICD10'))

# COMMAND ----------

# MAGIC %md # 6. Save

# COMMAND ----------

# save name
outName = f'{param_table_codelist_outcomes}'.lower()
print(outName)
print('')

# save previous version for comparison purposes
tmpt = (
  spark.sql(f"""SHOW TABLES FROM {dbc}""")
  .select('tableName')
  .where(f.col('tableName') == outName)  
  .collect()
)
if(len(tmpt)>0):
  _datetimenow = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
  outName_pre = f'{outName}_pre{_datetimenow}'.lower()
  print(f'saving (previous version)')
  print(f'  {dbc}.{outName}')
  print(f'  as')
  print(f'  {dbc}.{outName_pre}')
  spark.table(f'{dbc}.{outName}').write.mode('overwrite').saveAsTable(f'{dbc}.{outName_pre}')
  # spark.sql(f'ALTER TABLE {dbc}.{outName_pre} OWNER TO {dbc}')
  print('saved')
  print('')  

# save
print(f'saving')
print(f'  codelist') # change to be dynamic when time
print(f'  as')
print(f'  {dbc}.{outName}')
codelist.write.mode('overwrite').saveAsTable(f'{dbc}.{outName}')
# spark.sql(f'ALTER TABLE {dbc}.{outName} OWNER TO {dbc}')
print('saved')

# COMMAND ----------

tmp = spark.sql(f"SHOW TABLES FROM {dbc}")\
  .where(f.col('tableName').rlike('ccu052_01_c01_v01_codelist_outcomes_pre'))\
  .orderBy(f.desc('tableName'))
display(tmp)

# COMMAND ----------

# check
old = spark.table(f'{dbc}.{param_table_codelist_outcomes}_pre20231106_205108')
new = spark.table(f'{dbc}.{param_table_codelist_outcomes}')
key = ['name', 'code']
file1, file2, file3, file3_differences = compare_files(old, new, key, warningError=0)

# COMMAND ----------

tmpt = tab(file2, 'name'); print()
tmpt = tab(file3, 'name'); print()

# COMMAND ----------

# print(file1.toPandas().T.to_string()); print()
# print(file2.toPandas().T.to_string()); print()

# COMMAND ----------

codelist = spark.table(f'{dbc}.{param_table_codelist_outcomes}')
display(codelist.where(f.col('terminology') == 'ICD10').orderBy('CODE'))

# COMMAND ----------

display(codelist.where(f.col('terminology') == 'ICD10').where(f.length(f.col('CODE')) > 4).orderBy('CODE'))

# COMMAND ----------

icd10 = spark.table(f'{param_path_ref_icd10}').where(f.col('CODE').rlike('J45'))
display(icd10)